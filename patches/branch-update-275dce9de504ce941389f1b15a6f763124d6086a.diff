diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/configure.in openoffice.org-3.2.1/ooo-build-3-2-1-1/configure.in
index de91cf7..2e8ff13 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/configure.in
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/configure.in
@@ -1790,12 +1790,8 @@ To build run:
 $warn_use_download	make
 	bin/ooinstall <path-to-install>
 
-	This is 'master' - the main, but unstable branch.
-
-	If you want to build the stable OOo, use:
-		ooo-build-2-4    branch for 2.4
-		ooo-build-3-1-1  branch for 3.1.1
-		ooo-build-3-2    branch for 3.2
+	This is ooo-build-3-2-1 - the stable branch for the 3.2.1 release.
+	If you want to build something cool, unstable, and risky, use master.
 "
 
 if test "$BUILD_WIN32" != "yes" -a "$ENABLE_ICECREAM" != "yes"; then
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apple-remote-update.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apple-remote-update.diff
deleted file mode 100644
index 8cb566f..0000000
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apple-remote-update.diff
+++ /dev/null
@@ -1,67 +0,0 @@
-diff -r 5c6b8c37653f apple_remote/AppleRemote.m
---- apple_remote/AppleRemote.m	Tue Dec 15 14:27:37 2009 +0100
-+++ apple_remote/AppleRemote.m	Tue Dec 15 19:18:56 2009 +0100
-@@ -43,6 +43,10 @@
- 	#define NSAppKitVersionNumber10_4 824
- #endif
- 
-+#ifndef NSAppKitVersionNumber10_5
-+    #define NSAppKitVersionNumber10_5 949
-+#endif
-+
- @implementation AppleRemote
- 
- + (const char*) remoteControlDeviceName {
-@@ -52,7 +56,12 @@
- - (void) setCookieMappingInDictionary: (NSMutableDictionary*) _cookieToButtonMapping	{	
-     
-     // TODO : avoid such magics 
--	if (floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_4) {
-+	if (floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_4) 
-+    {
-+        #ifdef DEBUG
-+            NSLog( @"setting 10.4 cookies" );
-+        #endif
-+
- 		// 10.4.x Tiger
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlus]		forKey:@"14_12_11_6_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMinus]		forKey:@"14_13_11_6_"];		
-@@ -65,7 +74,12 @@
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu_Hold]	forKey:@"14_6_14_6_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay_Hold]	forKey:@"18_14_6_18_14_6_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteControl_Switched]	forKey:@"19_"];			
--	} else {
-+	} 
-+    else if( floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_5 )
-+    {
-+        #ifdef DEBUG
-+            NSLog( @"setting 10.5 cookies" );
-+        #endif
- 		// 10.5.x Leopard
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlus]		forKey:@"31_29_28_19_18_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMinus]		forKey:@"31_30_28_19_18_"];	
-@@ -78,6 +92,24 @@
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu_Hold]	forKey:@"31_19_18_31_19_18_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay_Hold]	forKey:@"35_31_19_18_35_31_19_18_"];
- 		[_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteControl_Switched]	forKey:@"19_"];			
-+    }    
-+    else
-+    {
-+        #ifdef DEBUG
-+            NSLog( @"setting 10.6 cookies" );
-+        #endif
-+        // 10.6.x Snow Leopard
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlus]		forKey:@"33_31_30_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMinus]		forKey:@"33_32_30_21_20_2_"];	
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu]		forKey:@"33_22_21_20_2_33_22_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay]		forKey:@"33_23_21_20_2_33_23_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonRight]		forKey:@"33_24_21_20_2_33_24_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonLeft]		forKey:@"33_25_21_20_2_33_25_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonRight_Hold]	forKey:@"33_21_20_14_12_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonLeft_Hold]	forKey:@"33_21_20_13_12_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonMenu_Hold]	forKey:@"33_21_20_2_33_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteButtonPlay_Hold]	forKey:@"37_33_21_20_2_37_33_21_20_2_"];
-+        [_cookieToButtonMapping setObject:[NSNumber numberWithInt:kRemoteControl_Switched]	forKey:@"19_"];
- 	}
- }
- 
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apply openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apply
index 1871f55..b3c8ab2 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apply
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/apply
@@ -665,6 +665,8 @@ sw-ww8font-fix.diff, cbosdo
 sw-show-Remove-Hyperlink-even-with-selection.diff, alvarezp2000
 sw-preserve-char-style-on-reset-format.diff, i#47893, alvarezp2000
 
+sw-num-fix.diff, n#569266, cbosdo
+
 # Refresh the cell formatting after pasting in it
 sw-paste-table.diff, n#564789, cbosdo
 
@@ -871,7 +873,7 @@ calc-general-type-auto-decimal-officecfg.diff, n#541973, i#46511, kohei
 calc-general-type-auto-decimal-sc-dbf-fix.diff, i#111074, kohei
 
 # Disable text wrap for numeric values.
-calc-general-type-auto-decimal-disable-linebreak.diff, kohei
+calc-general-type-auto-decimal-disable-linebreak.diff, i#111387, kohei
 
 # Tweak the default display format to hide the ugliness of IEEE 754 rounding error.
 calc-general-type-auto-decimal-ieee754-fix.diff, i#111533, kohei
@@ -1250,7 +1252,7 @@ transex3-localize-gsicheck-path.diff, i#109378, pmladek
 [ Fixes < dev300-m66 ]
 armeabi-softfp-buildfix.diff, i#105302, doko
 
-[ Fixes and not Win32Only ]
+[ Fixes and not Win32Only and not MacOSXOnly ]
 # fix ARM bridges
 fix-arm-eabi-bridge.diff, i#105359, cmc
 
@@ -2559,8 +2561,6 @@ novell-win32-msi-patchability.diff, tml
 
 [ MacOSXOnly ]
 SectionOwner => thorsten
-# backport from 3.3, enables apple remote for newer systems
-apple-remote-update.diff, i#107648, thorsten
 sfx2-global-scope-fix.diff, thorsten
 cws-kohei03-sc-macfix.diff, thorsten
 
@@ -3904,8 +3904,9 @@ transogl-crossplatform.diff, ericb
 # embed generic media files inside odf docs, 1st part
 # FIXME: svx-sound.diff depends on this diff
 cws-impressmedia01-backport.diff, i#83753, thorsten
-
+cws-impressmedia01-slotparams-fix.diff, n#597691, thorsten
 cws-impressmedia01-crash-fix.diff, n#588570, thorsten
+cws-impressmedia01-linkfix.diff, thorsten
 
 [ Fixes ]
 svx-sound.diff, n#515553, rodo
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff
index 3981a13..86d3470 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/calc-general-type-auto-decimal-disable-linebreak.diff
@@ -49,19 +49,19 @@ index 0ce77fb..d303e45 100644
          if (nScript == 0) nScript = ScGlobal::GetDefaultScriptType();
  
 diff --git sc/source/ui/view/output2.cxx sc/source/ui/view/output2.cxx
-index 35f48bf..301a973 100644
+index 8c7e649..ad3549f 100644
 --- sc/source/ui/view/output2.cxx
 +++ sc/source/ui/view/output2.cxx
 @@ -75,6 +75,8 @@
  #include "scmod.hxx"
  #include "fillinfo.hxx"
  
-+#include <boost/scoped_ptr.hpp>
++#include <boost/ptr_container/ptr_vector.hpp>
 +
  #include <math.h>
  
  //!	Autofilter-Breite mit column.cxx zusammenfassen
-@@ -1324,10 +1326,6 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
+@@ -1344,10 +1346,6 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
  
      ScDrawStringsVars aVars( this, bPixelToLogic );
  
@@ -72,7 +72,7 @@ index 35f48bf..301a973 100644
      BOOL bProgress = FALSE;
  
      long nInitPosX = nScrX;
-@@ -1350,6 +1348,13 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
+@@ -1370,6 +1368,13 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
      SvxCellHorJustify eOutHorJust = SVX_HOR_JUSTIFY_STANDARD;
      const ScPatternAttr* pPattern = NULL;
      const SfxItemSet* pCondSet = NULL;
@@ -80,13 +80,13 @@ index 35f48bf..301a973 100644
 +    const SfxItemSet* pOldCondSet = NULL;
 +    BYTE nOldScript = 0;
 +
-+    // alternative pattern instance in case we need to modify the pattern 
++    // alternative pattern instances in case we need to modify the pattern 
 +    // before processing the cell value.
-+    ::boost::scoped_ptr<ScPatternAttr> pAltPattern;
++    ::boost::ptr_vector<ScPatternAttr> aAltPatterns;
  
      long nPosY = nScrY;
      for (SCSIZE nArrY=1; nArrY+1<nArrCount; nArrY++)
-@@ -1487,6 +1492,17 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
+@@ -1507,6 +1512,18 @@ void ScOutputData::DrawStrings( BOOL bPixelToLogic )
                          pCondSet = pDoc->GetCondResult( nCellX, nCellY, nTab );
                      }
  
@@ -95,10 +95,11 @@ index 35f48bf..301a973 100644
 +                            pPattern->GetItem(ATTR_LINEBREAK, pCondSet)).GetValue())
 +                    {
 +                        // Disable line break when the cell content is numeric.
-+                        pAltPattern.reset(new ScPatternAttr(*pPattern));
++                        aAltPatterns.push_back(new ScPatternAttr(*pPattern));
++                        ScPatternAttr* pAltPattern = &aAltPatterns.back();
 +                        SfxBoolItem aLineBreak(ATTR_LINEBREAK, false);
 +                        pAltPattern->GetItemSet().Put(aLineBreak);
-+                        pPattern = pAltPattern.get();
++                        pPattern = pAltPattern;
 +                    }
 +
                      BYTE nScript = GetScriptType( pDoc, pCell, pPattern, pCondSet );
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-linkfix.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-linkfix.diff
new file mode 100644
index 0000000..78ab0c6
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-linkfix.diff
@@ -0,0 +1,36 @@
+Replace Package uri with relative path, for embedded media
+
+From: Thorsten Behrens <tbehrens@novell.com>
+
+
+---
+
+ xmloff/source/draw/shapeexport2.cxx       |   14 +++++++++++++-
+ 1 files changed, 34 insertions(+), 2 deletions(-)
+
+
+diff --git xmloff/source/draw/shapeexport2.cxx xmloff/source/draw/shapeexport2.cxx
+index 2a10dc2..1137372 100644
+--- xmloff/source/draw/shapeexport2.cxx
++++ xmloff/source/draw/shapeexport2.cxx
+@@ -1966,7 +1966,19 @@ void XMLShapeExport::ImpExportMediaShape(
+         // export media url
+         OUString aMediaURL;
+         xPropSet->getPropertyValue( OUString( RTL_CONSTASCII_USTRINGPARAM( "MediaURL" ) ) ) >>= aMediaURL;
+-        mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_HREF, GetExport().GetRelativeReference( aMediaURL ) );
++
++        const rtl::OUString sPackageURL( RTL_CONSTASCII_USTRINGPARAM("vnd.sun.star.Package:") );
++        if( aMediaURL.match( sPackageURL, 0 ) )
++        {
++            // embedded media, strip package prefix
++            aMediaURL = aMediaURL.copy( sPackageURL.getLength(), 
++                                        aMediaURL.getLength() - sPackageURL.getLength() );
++        }
++        else
++        {
++            aMediaURL = GetExport().GetRelativeReference( aMediaURL );
++        }
++        mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_HREF, aMediaURL );
+         mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_TYPE, XML_SIMPLE );
+         mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_SHOW, XML_EMBED );
+         mrExport.AddAttribute ( XML_NAMESPACE_XLINK, XML_ACTUATE, XML_ONLOAD );
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-slotparams-fix.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-slotparams-fix.diff
new file mode 100644
index 0000000..1a4f2df
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/cws-impressmedia01-slotparams-fix.diff
@@ -0,0 +1,85 @@
+Give additional slot call parameters for SID_INSERT_AVMEDIA
+
+From: Thorsten Behrens <tbehrens@novell.com>
+
+
+---
+
+ avmedia/source/framework/mediaplayer.cxx |    8 +++++++-
+ sc/source/ui/view/tabvwsh9.cxx           |    4 +++-
+ sd/source/ui/view/drviews9.cxx           |    4 +++-
+ sw/source/ui/shells/basesh.cxx           |    4 +++-
+ 4 files changed, 16 insertions(+), 4 deletions(-)
+
+
+diff --git avmedia/source/framework/mediaplayer.cxx avmedia/source/framework/mediaplayer.cxx
+index 1042c8e..8f172ff 100644
+--- avmedia/source/framework/mediaplayer.cxx
++++ avmedia/source/framework/mediaplayer.cxx
+@@ -36,6 +36,7 @@
+ #include "helpids.hrc"
+ 
+ #include <svtools/stritem.hxx>
++#include <svtools/eitem.hxx>
+ #include <sfx2/app.hxx>
+ #include <sfx2/sfxsids.hrc>
+ #include <sfx2/bindings.hxx>
+@@ -162,7 +163,12 @@ void MediaFloater::dispatchCurrentURL()
+     if( pDispatcher )
+     {	
+         const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, getURL() );
+-        pDispatcher->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_RECORD, &aMediaURLItem, 0L );
++        const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++        pDispatcher->Execute( SID_INSERT_AVMEDIA, 
++                              SFX_CALLMODE_RECORD, 
++                              &aMediaURLItem, 
++                              &aLinkFlagItem, 
++                              0L );
+     }
+ }
+ 
+diff --git sc/source/ui/view/tabvwsh9.cxx sc/source/ui/view/tabvwsh9.cxx
+index 88ebdc9..8ea0417 100644
+--- sc/source/ui/view/tabvwsh9.cxx
++++ sc/source/ui/view/tabvwsh9.cxx
+@@ -154,7 +154,9 @@ void ScTabViewShell::ExecGallery( SfxRequest& rReq )
+                 if ( pGal )
+                 {
+                     const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+-                       GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
++                    const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++                       GetViewFrame()->GetDispatcher()->Execute( 
++                           SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
+                 }
+             }
+         }
+diff --git sd/source/ui/view/drviews9.cxx sd/source/ui/view/drviews9.cxx
+index 57064c6..0f8dd8c 100644
+--- sd/source/ui/view/drviews9.cxx
++++ sd/source/ui/view/drviews9.cxx
+@@ -220,7 +220,9 @@ void DrawViewShell::ExecGallery(SfxRequest& rReq)
+             else if( nFormats & SGA_FORMAT_SOUND )
+             {
+                 const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+-                   GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
++                const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++                GetViewFrame()->GetDispatcher()->Execute( 
++                    SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
+             }
+ 
+             GetDocSh()->SetWaitCursor( FALSE );
+diff --git sw/source/ui/shells/basesh.cxx sw/source/ui/shells/basesh.cxx
+index a32d3e1..c891e53 100644
+--- sw/source/ui/shells/basesh.cxx
++++ sw/source/ui/shells/basesh.cxx
+@@ -776,7 +776,9 @@ void SwBaseShell::Execute(SfxRequest &rReq)
+                 else if(!rSh.IsSelFrmMode() && SGA_FORMAT_SOUND & ((SfxUInt32Item*)pItem)->GetValue())
+                 {
+                     const SfxStringItem aMediaURLItem( SID_INSERT_AVMEDIA, pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+-                       GetView().GetViewFrame()->GetDispatcher()->Execute( SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, 0L );
++                    const SfxBoolItem   aLinkFlagItem( FN_PARAM_1, FALSE );
++                       GetView().GetViewFrame()->GetDispatcher()->Execute( 
++                           SID_INSERT_AVMEDIA, SFX_CALLMODE_SYNCHRON, &aMediaURLItem, &aLinkFlagItem, 0L );
+ /*
+                     String sURL( pGal->GetURL().GetMainURL( INetURLObject::NO_DECODE ) );
+                     String sLabel( pGal->GetURL().getBase() );
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/mdds-makefile-mk.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/mdds-makefile-mk.diff
index b485edf..57d1945 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/mdds-makefile-mk.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/mdds-makefile-mk.diff
@@ -1,6 +1,6 @@
 --- /dev/null	
 +++ mdds/makefile.mk	
-@@ -0,0 +1,66 @@
+@@ -0,0 +1,69 @@
 +#*************************************************************************
 +#
 +# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
@@ -61,9 +61,12 @@
 +
 +# --- post-build ---------------------------------------------------
 +
++NORMALIZE_FLAG_FILE=so_normalized_$(TARGET)
++
 +$(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE) : $(PACKAGE_DIR)$/$(BUILD_FLAG_FILE)
 +	-@$(MKDIRHIER) $(INCCOM)
-+	@$(GNUCOPY) -r $(PACKAGE_DIR)/$(TARFILE_NAME)/inc/mdds $(INCCOM)/
++	@$(GNUCOPY) -r $(PACKAGE_DIR)$/$(TARFILE_NAME)$/inc$/mdds $(INCCOM)
++	@$(TOUCH) $(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE)
 +
 +$(PACKAGE_DIR)$/$(PREDELIVER_FLAG_FILE) : $(PACKAGE_DIR)$/$(NORMALIZE_FLAG_FILE)
 +
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/sw-num-fix.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/sw-num-fix.diff
new file mode 100644
index 0000000..3d2d2bb
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/sw-num-fix.diff
@@ -0,0 +1,22 @@
+diff --git sw/source/filter/rtf/rtfatr.cxx sw/source/filter/rtf/rtfatr.cxx
+index bbe9030..7f191ad 100644
+--- sw/source/filter/rtf/rtfatr.cxx
++++ sw/source/filter/rtf/rtfatr.cxx
+@@ -1223,7 +1223,7 @@ static Writer& OutRTF_SwTxtNode( Writer& rWrt, SwCntntNode& rNode )
+     }
+ 
+     // gibt es harte Attributierung ?
+-    if( bNewFmts && pNd->HasSwAttrSet())
++    if( pNd->HasSwAttrSet() )
+     {
+         rRTFWrt.pFlyFmt = 0;
+ 
+@@ -1246,7 +1246,7 @@ static Writer& OutRTF_SwTxtNode( Writer& rWrt, SwCntntNode& rNode )
+             SfxItemSet aSet( rNdSet );
+             SvxLRSpaceItem aLR( (SvxLRSpaceItem&)rNdSet.Get( RES_LR_SPACE ) );
+ 
+-            aLR.SetTxtLeft( aLR.GetTxtLeft() + pFmt->GetAbsLSpace() );
++            aLR.SetTxtLeft( aLR.GetTxtLeft() + pFmt->GetIndentAt() );
+             if( MAXLEVEL > pNd->GetActualListLevel() )
+                 aLR.SetTxtFirstLineOfst( pFmt->GetFirstLineOffset() );
+             else
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/transogl-crossplatform.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/transogl-crossplatform.diff
index 0c9ebe3..5e76c70 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/transogl-crossplatform.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/transogl-crossplatform.diff
@@ -98,17 +98,8 @@ index fbbb575..e2cb301 100644
  mkdir: %_DEST%\inc%_EXT%\boost\mpl
  mkdir: %_DEST%\inc%_EXT%\boost\mpl\aux_
  mkdir: %_DEST%\inc%_EXT%\boost\mpl\aux_\config
-@@ -83,6 +90,8 @@ mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\seq\detail
- mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\slot
- mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\slot\detail
- mkdir: %_DEST%\inc%_EXT%\boost\preprocessor\tuple
-+mkdir: %_DEST%\inc%_EXT%\boost\range
-+mkdir: %_DEST%\inc%_EXT%\boost\range\detail
- mkdir: %_DEST%\inc%_EXT%\boost\spirit
- mkdir: %_DEST%\inc%_EXT%\boost\spirit\actor
- mkdir: %_DEST%\inc%_EXT%\boost\spirit\attribute
 @@ -306,8 +315,18 @@ mkdir: %_DEST%\inc%_EXT%\boost\variant\detail
- ..\%__SRC%\inc\boost\utility\* %_DEST%\inc%_EXT%\boost\utility
+ ..\%__SRC%\inc\boost\utility\detail\* %_DEST%\inc%_EXT%\boost\utility\detail
  ..\%__SRC%\inc\boost\variant\* %_DEST%\inc%_EXT%\boost\variant
  ..\%__SRC%\inc\boost\variant\detail\* %_DEST%\inc%_EXT%\boost\variant\detail
 +..\%__SRC%\misc\build\boost_1_39_0\boost\algorithm\string\* %_DEST%\inc%_EXT%\boost\algorithm\string\
@@ -266,18 +257,15 @@ deleted file mode 100644
 index a144790..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_Shaders.cxx
 +++ /dev/null
-@@ -1,143 +0,0 @@
+@@ -1,140 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: $
-- * $Revision: $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -415,18 +403,15 @@ deleted file mode 100644
 index 049c71f..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_Shaders.hxx
 +++ /dev/null
-@@ -1,71 +0,0 @@
+@@ -1,68 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: $
-- * $Revision: $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -492,18 +477,15 @@ deleted file mode 100644
 index de63a1b..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_TransitionImpl.cxx
 +++ /dev/null
-@@ -1,1318 +0,0 @@
+@@ -1,1315 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: OGLTrans_TransitionImpl.cxx,v $
-- * $Revision: 1.5 $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -1816,18 +1798,15 @@ deleted file mode 100644
 index 2aa0529..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_TransitionImpl.hxx
 +++ /dev/null
-@@ -1,509 +0,0 @@
+@@ -1,506 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: OGLTrans_TransitionImpl.hxx,v $
-- * $Revision: 1.5 $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -2331,18 +2310,15 @@ deleted file mode 100644
 index 01d513c..0000000
 --- slideshow/source/engine/OGLTrans/OGLTrans_TransitionerImpl.cxx
 +++ /dev/null
-@@ -1,1487 +0,0 @@
+@@ -1,1484 +0,0 @@
 -/*************************************************************************
 - *
 - * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 - * 
-- * Copyright 2008 by Sun Microsystems, Inc.
+- * Copyright 2000, 2010 Oracle and/or its affiliates.
 - *
 - * OpenOffice.org - a multi-platform office productivity suite
 - *
-- * $RCSfile: OGLTrans_TransitionerImpl.cxx,v $
-- * $Revision: 1.6 $
-- *
 - * This file is part of OpenOffice.org.
 - *
 - * OpenOffice.org is free software: you can redistribute it and/or modify
@@ -7487,19 +7463,15 @@ deleted file mode 100644
 index 6353b2d..0000000
 --- slideshow/source/engine/OGLTrans/makefile.mk
 +++ /dev/null
-@@ -1,84 +0,0 @@
+@@ -1,80 +0,0 @@
 -#*************************************************************************
 -#
 -# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 -# 
--# Copyright 2008 by Sun Microsystems, Inc.
+-# Copyright 2000, 2010 Oracle and/or its affiliates.
 -#
 -# OpenOffice.org - a multi-platform office productivity suite
 -#
--# $RCSfile: makefile.mk,v $
--#
--# $Revision: 1.5 $
--#
 -# This file is part of OpenOffice.org.
 -#
 -# OpenOffice.org is free software: you can redistribute it and/or modify
diff --git openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/writer-doc-comparison.diff openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/writer-doc-comparison.diff
index 23cc606..93c1751 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/writer-doc-comparison.diff
+++ openoffice.org-3.2.1/ooo-build-3-2-1-1/patches/dev300/writer-doc-comparison.diff
@@ -1,6 +1,6 @@
 Tzvetelinas gsoc project - writer document comparison
 
-From: Thorsten Behrens <thb@openoffice.org>
+From: Thorsten Behrens <tbehrens@novell.com>
 
 
 ---
@@ -38,6 +38,7 @@ From: Thorsten Behrens <thb@openoffice.org>
  sw/source/filter/html/css1atr.cxx                  |    3 
  sw/source/filter/html/htmlatr.cxx                  |    2 
  sw/source/filter/rtf/rtfatr.cxx                    |    3 
+ sw/source/filter/xml/xmlexp.cxx                    |    8 
  sw/source/ui/app/appopt.cxx                        |    1 
  sw/source/ui/app/docsh.cxx                         |    3 
  sw/source/ui/app/swmodul1.cxx                      |   40 +
@@ -57,7 +58,7 @@ From: Thorsten Behrens <thb@openoffice.org>
  xmloff/source/style/xmlbahdl.cxx                   |   42 +
  xmloff/source/style/xmlbahdl.hxx                   |   12 
  xmloff/source/text/txtprmap.cxx                    |    8 
- 52 files changed, 1876 insertions(+), 153 deletions(-)
+ 53 files changed, 1884 insertions(+), 153 deletions(-)
  create mode 100644 svx/inc/svx/rsiditem.hxx
 
 
@@ -2268,6 +2269,25 @@ index bbe9030..faeb5ed 100644
  
  /* RES_PARATR_LIST_ID */            0, // new
  /* RES_PARATR_LIST_LEVEL */         0, // new
+diff --git sw/source/filter/xml/xmlexp.cxx sw/source/filter/xml/xmlexp.cxx
+index f2ec2a7..17010e2 100644
+--- sw/source/filter/xml/xmlexp.cxx
++++ sw/source/filter/xml/xmlexp.cxx
+@@ -240,6 +240,14 @@ sal_uInt32 SwXMLExport::exportDoc( enum XMLTokenEnum eClass )
+     if( (getExportFlags() & (EXPORT_FONTDECLS|EXPORT_STYLES|
+                              EXPORT_MASTERSTYLES|EXPORT_CONTENT)) != 0 )
+     {
++        if( getDefaultVersion() == SvtSaveOptions::ODFVER_LATEST )
++        {
++            _GetNamespaceMap().Add(
++                GetXMLToken(XML_NP_OFFICE_EXT),
++                GetXMLToken(XML_N_OFFICE_EXT), 
++                XML_NAMESPACE_OFFICE_EXT);
++        }
++
+         GetTextParagraphExport()->SetBlockMode( bBlock );
+ 
+         const SfxPoolItem* pItem;
 diff --git sw/source/ui/app/appopt.cxx sw/source/ui/app/appopt.cxx
 index 1f178d4..e77bf2a 100644
 --- sw/source/ui/app/appopt.cxx
@@ -3015,7 +3035,7 @@ index 9c4e1c3..fbbbbeb 100644
  */
  class XMLStringPropHdl : public XMLPropertyHandler
 diff --git xmloff/source/text/txtprmap.cxx xmloff/source/text/txtprmap.cxx
-index e68469f..6a6e960 100644
+index e68469f..c7758d3 100644
 --- xmloff/source/text/txtprmap.cxx
 +++ xmloff/source/text/txtprmap.cxx
 @@ -149,6 +149,10 @@ XMLPropertyMapEntry aXMLParaPropMap[] =
@@ -3023,9 +3043,9 @@ index e68469f..6a6e960 100644
      // RES_CHRATR_WEIGHT
      MT_E( "CharWeight",		FO,		FONT_WEIGHT,		XML_TYPE_TEXT_WEIGHT, 0 ),
 +	// RES_CHRATR_RSID
-+	MT_E( "Rsid",		TEXT,		RSID,		XML_TYPE_HEX, 0 ),
++    { "Rsid", sizeof("Rsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_RSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
 +	// RES_PARATR_RSID
-+	MT_E( "ParRsid",	TEXT,		PARRSID,	XML_TYPE_HEX, 0 ),
++    { "ParRsid", sizeof("ParRsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_PARRSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
      // RES_CHRATR_WORDLINEMODE
      MT_E( "CharWordMode",	STYLE,	TEXT_UNDERLINE_MODE,		XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
      MT_E( "CharWordMode",   STYLE,  TEXT_OVERLINE_MODE,     XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
@@ -3034,9 +3054,9 @@ index e68469f..6a6e960 100644
      // RES_CHRATR_WEIGHT
      MT_E( "CharWeight",		FO,		FONT_WEIGHT,		XML_TYPE_TEXT_WEIGHT, 0 ),
 +	// RES_CHRATR_RSID
-+	MT_E( "Rsid",		TEXT,		RSID,		XML_TYPE_HEX, 0 ),
++    { "Rsid", sizeof("Rsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_RSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
 +	// RES_PARATR_RSID
-+	MT_E( "ParRsid",	TEXT,		PARRSID,	XML_TYPE_HEX, 0 ),
++    { "ParRsid", sizeof("ParRsid")-1, XML_NAMESPACE_OFFICE_EXT, XML_PARRSID, XML_TYPE_HEX|XML_TYPE_PROP_TEXT, 0, SvtSaveOptions::ODFVER_LATEST },
      // RES_CHRATR_WORDLINEMODE
      MT_E( "CharWordMode",	STYLE,	TEXT_UNDERLINE_MODE,		XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
      MT_E( "CharWordMode",   STYLE,  TEXT_OVERLINE_MODE,     XML_TYPE_TEXT_LINE_MODE|MID_FLAG_MERGE_PROPERTY, 0 ),
