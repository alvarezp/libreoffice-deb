--- oo_1.0.1_src/xmlhelp/source/cxxhelp/provider/urlparameter.cxx.help-fallback-en	2001-10-31 14:08:14.000000000 +0100
+++ oo_1.0.1_src/xmlhelp/source/cxxhelp/provider/urlparameter.cxx	2002-08-26 14:46:51.000000000 +0200
@@ -266,13 +266,33 @@ rtl::OUString URLParameter::get_title()
 	
 	return m_aTitle;
 }
-		
+
 
 rtl::OUString URLParameter::get_language()
 {
 	if( m_aLanguage.getLength() == 0 )
 		return m_aDefaultLanguage;
 	
+	// Check that we have the necessary files. The rationale is if
+	// help/<lang>/err.html exists then, we have localized help
+	// data, possibly not installed. Otherwise, we won't have
+	// localized help and we try to fallback to English.
+	rtl::OUString fileURL = 
+		m_pDatabases->getInstallPathAsURL()
+		+ m_pDatabases->lang( m_aLanguage )
+		+ rtl::OUString::createFromAscii( "/err.html" );
+	
+	osl::DirectoryItem aDirItem;
+	osl::File aFile( fileURL );
+	osl::FileStatus aStatus( FileStatusMask_FileSize );
+	
+	if( osl::FileBase::E_None != osl::DirectoryItem::get( fileURL,aDirItem ) ||
+		osl::FileBase::E_None != aFile.open( OpenFlag_Read )       ||
+		osl::FileBase::E_None != aDirItem.getFileStatus( aStatus ) )
+	{
+		m_aLanguage = rtl::OUString::createFromAscii( "en-US" );
+	}
+	
 	return m_aLanguage;
 }
 
--- oo_1.0.1_src/xmlhelp/source/treeview/tvread.cxx.help-fallback-en	2001-11-08 17:42:46.000000000 +0100
+++ oo_1.0.1_src/xmlhelp/source/treeview/tvread.cxx	2002-08-26 14:41:38.000000000 +0200
@@ -704,7 +704,27 @@ ConfigData TVChildTarget::init( const Re
 															   aDirItem ) )
 		ret = locale.copy( 0,idx );
 	
-	url = url + ret;
+	rtl::OUString test_url = url + ret;
+	{
+		// Check that we have the necessary files. The rationale is if
+		// help/<lang>/err.html exists then, we have localized help
+		// data, possibly not installed. Otherwise, we won't have
+		// localized help and we try to fallback to English.
+		rtl::OUString errfileURL = test_url + rtl::OUString::createFromAscii( "/err.html" );
+		
+		osl::DirectoryItem aDirItem;
+		osl::File aFile( errfileURL );
+		osl::FileStatus aStatus( FileStatusMask_FileSize );
+	
+		if( osl::FileBase::E_None != osl::DirectoryItem::get( errfileURL,aDirItem ) ||
+			osl::FileBase::E_None != aFile.open( OpenFlag_Read )       ||
+			osl::FileBase::E_None != aDirItem.getFileStatus( aStatus ) )
+		{
+			locale = rtl::OUString::createFromAscii( "en-US" );
+			test_url = url + locale.copy( 0, 2 );
+		}
+	}
+	url = test_url;
 	
 	// first of all, try do determine whether there are any *.tree files present
 	
