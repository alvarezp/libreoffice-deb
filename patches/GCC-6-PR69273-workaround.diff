From 772ae03e1e680106dcdd08fae51d15d9df7c7931 Mon Sep 17 00:00:00 2001
From: Stephan Bergmann <sbergman@redhat.com>
Date: Wed, 20 Jan 2016 09:34:57 +0100
Subject: [PATCH 1/2] GCC 6 PR69273 workaround

see <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=69273>

Change-Id: I4a9ba50f68f3f08f878c530f05a18b2b63f29b2a
---
 sc/source/filter/oox/autofiltercontext.cxx  | 3 ++-
 sc/source/filter/oox/pivottablefragment.cxx | 3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/sc/source/filter/oox/autofiltercontext.cxx b/sc/source/filter/oox/autofiltercontext.cxx
index 11f0da8..671de7e 100644
--- a/sc/source/filter/oox/autofiltercontext.cxx
+++ b/sc/source/filter/oox/autofiltercontext.cxx
@@ -35,10 +35,11 @@ FilterSettingsContext::FilterSettingsContext( WorksheetContextBase& rParent, Fil
 
 ContextHandlerRef FilterSettingsContext::onCreateContext( sal_Int32 nElement, const AttributeList& /*rAttribs*/ )
 {
+    ContextHandlerRef gcc_pr69273_workaround(this);
     switch( getCurrentElement() )
     {
         case XLS_TOKEN( filters ):
-            if( nElement == XLS_TOKEN( filter ) ) return this;
+            if( nElement == XLS_TOKEN( filter ) ) return gcc_pr69273_workaround;
         break;
         case XLS_TOKEN( customFilters ):
             if( nElement == XLS_TOKEN( customFilter ) ) return this;
diff --git a/sc/source/filter/oox/pivottablefragment.cxx b/sc/source/filter/oox/pivottablefragment.cxx
index ca26708..fc4817d 100644
--- a/sc/source/filter/oox/pivottablefragment.cxx
+++ b/sc/source/filter/oox/pivottablefragment.cxx
@@ -113,10 +113,11 @@ PivotTableFilterContext::PivotTableFilterContext( WorksheetFragmentBase& rFragme
 
 ContextHandlerRef PivotTableFilterContext::onCreateContext( sal_Int32 nElement, const AttributeList& rAttribs )
 {
+    ContextHandlerRef gcc_pr69273_workaround(this);
     switch( getCurrentElement() )
     {
         case XLS_TOKEN( filter ):
-            if( nElement == XLS_TOKEN( autoFilter ) ) return this;
+            if( nElement == XLS_TOKEN( autoFilter ) ) return gcc_pr69273_workaround;
         break;
         case XLS_TOKEN( autoFilter ):
             if( nElement == XLS_TOKEN( filterColumn ) ) return this;
-- 
2.4.3

