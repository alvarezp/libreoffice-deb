--- openoffice.org-3.2.1/ooo-build-3-2-1-4/patches/dev300/calc-formula-variable-separators-sc.diff-old	2010-11-03 21:14:08.000000000 +0100
+++ openoffice.org-3.2.1/ooo-build-3-2-1-4/patches/dev300/calc-formula-variable-separators-sc.diff	2010-11-03 21:16:03.000000000 +0100
@@ -319,7 +319,7 @@
      aLayoutItem( OUString::createFromAscii( CFGPATH_DOCLAYOUT ) )
  {
      sal_Int32 nIntVal = 0;
-@@ -328,6 +423,69 @@ ScDocCfg::ScDocCfg() :
+@@ -328,6 +423,72 @@ ScDocCfg::ScDocCfg() :
  
      SetDate( nDateDay, nDateMonth, nDateYear );
  
@@ -335,7 +335,8 @@
 +            {
 +                case SCFORMULAOPT_GRAMMAR:
 +                {
-+                    ::formula::FormulaGrammar::Grammar eGram = ::formula::FormulaGrammar::GRAM_DEFAULT;
++                    // Get default value in case this option is not set.
++                    ::formula::FormulaGrammar::Grammar eGram = GetFormulaSyntax();
 +
 +                    do
 +                    {
@@ -354,6 +355,8 @@
 +                            case 2: // Excel R1C1
 +                                eGram = ::formula::FormulaGrammar::GRAM_NATIVE_XL_R1C1;
 +                            break;
++                            default:
++                                ;
 +                        }
 +                    }
 +                    while (false);
