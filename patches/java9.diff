diff --git a/configure.ac b/configure.ac
index 93543ddccf4e..6ee677e222a1 100644
--- a/configure.ac
+++ b/configure.ac
@@ -7126,7 +6907,12 @@ then
             my_java_arch=$host_cpu
             ;;
         esac
-        JAWTLIB="-L$JAVA_HOME/jre/lib/$my_java_arch -ljawt"
+        # This is where JDK9 puts the library
+        if test -e "$JAVA_HOME/lib/libjawt.so"; then
+            JAWTLIB="-L$JAVA_HOME/lib/ -ljawt"
+        else
+            JAWTLIB="-L$JAVA_HOME/jre/lib/$my_java_arch -ljawt"
+        fi
         AS_IF([test "$JAVA_ARCH" != ""], [AC_DEFINE_UNQUOTED([JAVA_ARCH], ["$JAVA_ARCH"])])
     fi
     AC_MSG_RESULT([$JAWTLIB])
diff --git a/odk/settings/settings.mk b/odk/settings/settings.mk
index 2813959f5dec..684c39edae91 100644
--- a/odk/settings/settings.mk
+++ b/odk/settings/settings.mk
@@ -376,7 +376,7 @@ COMP_LINK_FLAGS=$(LIBRARY_LINK_FLAGS)
 
 EXE_LINK_FLAGS=-Wl,--allow-shlib-undefined -Wl,-export-dynamic -Wl,-z,defs -Wl,--no-whole-archive
 LINK_LIBS=-L"$(OUT)/lib" -L"$(OO_SDK_HOME)/lib" -L"$(OO_SDK_URE_LIB_DIR)"
-LINK_JAVA_LIBS=-L"$(OO_SDK_JAVA_HOME)/jre/lib/$(JAVA_PROC_TYPE)"
+LINK_JAVA_LIBS=-L"$(OO_SDK_JAVA_HOME)/jre/lib/$(JAVA_PROC_TYPE)" -L"$(OO_SDK_JAVA_HOME)/lib"
 
 URE_MISC=$(OFFICE_PROGRAM_PATH)
 
From 57adce8b88073b813aacb668629968f29b7d706a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fridrich=20=C5=A0trba?= <fridrich.strba@bluewin.ch>
Date: Mon, 4 Sep 2017 20:59:02 +0200
Subject: This hunk breaks jdk9 build

Change-Id: I80b6619a95ccac43a06ffd9b1b64dc1115510d90

diff --git a/external/rhino/rhino1_5R5.patch b/external/rhino/rhino1_5R5.patch
index e44872e..40fc6cc 100644
--- a/external/rhino/rhino1_5R5.patch
+++ b/external/rhino/rhino1_5R5.patch
@@ -185,14 +185,6 @@
    </target>
  
    <target name="compile" depends="properties,get-swing-ex">
-@@ -68,6 +54,7 @@
-            includes="org/**/*.java"
-            deprecation="on"
-            debug="${debug}">
-+      <compilerarg value="-Xbootclasspath:${toString:my.bootstrap.classpath}"/>
-     </javac>
-     <copy todir="${nest}/${classes}">
-       <fileset dir="." includes="org/**/*.properties" />
 --- misc/rhino1_5R5/toolsrc/org/mozilla/javascript/tools/debugger/Main.java	2004-03-25 21:54:34.000000000 +0100
 +++ misc/build/rhino1_5R5/toolsrc/org/mozilla/javascript/tools/debugger/Main.java	2009-01-17 20:44:22.000000000 +0100
 @@ -470,15 +470,21 @@
-- 
cgit v0.10.2

From fafeedc865821b1b0dc25b66afd54757d6440b16 Mon Sep 17 00:00:00 2001
From: Stephan Bergmann <sbergman@redhat.com>
Date: Thu, 21 Sep 2017 13:49:26 +0200
Subject: Fix creation of array clone

The original code caused ClassCastException when the return value of toArray()
was actually of type Object[] instead of Statement[].

Change-Id: I6cd451404b7bd22a9a0c3490b6982cc38e79d1b2

diff --git a/sfx2/qa/complex/sfx2/DocumentMetadataAccess.java b/sfx2/qa/complex/sfx2/DocumentMetadataAccess.java
index 4c23235..9a0e7b8 100644
--- a/sfx2/qa/complex/sfx2/DocumentMetadataAccess.java
+++ b/sfx2/qa/complex/sfx2/DocumentMetadataAccess.java
@@ -1006,8 +1006,7 @@ public class DocumentMetadataAccess
                 i_Expected.length);
             return false;
         }
-        Statement[] expected = (Statement[])
-            java.util.Arrays.asList(i_Expected).toArray();
+        Statement[] expected = i_Expected.clone();
         java.util.Arrays.sort(i_Result, new StmtComp());
         java.util.Arrays.sort(expected, new StmtComp());
         for (int i = 0; i < expected.length; ++i)
-- 
cgit v0.10.2

diff --git a/solenv/gbuild/JavaClassSet.mk b/solenv/gbuild/JavaClassSet.mk
index 58a16d95cf71..e7de44d6ccca 100644
--- a/solenv/gbuild/JavaClassSet.mk
+++ b/solenv/gbuild/JavaClassSet.mk
@@ -17,7 +17,8 @@
 #   the License at http://www.apache.org/licenses/LICENSE-2.0 .
 #
 
-gb_JavaClassSet_JAVACCOMMAND := $(ICECREAM_RUN) $(JAVACOMPILER) $(JAVAFLAGS) \
+gb_JavaClassSet_JAVACCOMMAND := JAVA_TOOL_OPTIONS=-Dfile.encoding=UTF8 \
+    $(ICECREAM_RUN) $(JAVACOMPILER) $(JAVAFLAGS) \
     -source $(JAVA_SOURCE_VER) -target $(JAVA_TARGET_VER) \
     $(if $(JAVA_CLASSPATH_NOT_SET),-Xlint:-options)
 gb_JavaClassSet_JAVACDEBUG :=
