From 576f899811a22e83b6fb6a120c8da303b1f4cac1 Mon Sep 17 00:00:00 2001
From: Miklos Vajna <vmiklos@collabora.co.uk>
Date: Thu, 7 Jun 2018 09:41:19 +0200
Subject: Fix CppunitTest_xmlsecurity_signing with system-xmlsec 1.2.26
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Swap the order of the default and custom callback registration, since
the order of lookup is now reversed since
<https://github.com/lsh123/xmlsec/commit/968646fb9b8428174a112fce2f08b1ec89d0ed97>.

Thanks Tomas Chvatal for reporting this.

Change-Id: I60a347454701a679db4ccd8924a723a236d5edff
Reviewed-on: https://gerrit.libreoffice.org/55404
Reviewed-by: Miklos Vajna <vmiklos@collabora.co.uk>
Tested-by: Tomáš Chvátal <tchvatal@suse.cz>
---
 xmlsecurity/source/xmlsec/xmlstreamio.cxx | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/xmlsecurity/source/xmlsec/xmlstreamio.cxx b/xmlsecurity/source/xmlsec/xmlstreamio.cxx
index de32f82..83dd83e 100644
--- a/xmlsecurity/source/xmlsec/xmlstreamio.cxx
+++ b/xmlsecurity/source/xmlsec/xmlstreamio.cxx
@@ -157,6 +157,25 @@ XSECXMLSEC_DLLPUBLIC int xmlEnableStreamInputCallbacks()
         //Notes: all none default callbacks will lose.
         xmlSecIOCleanupCallbacks() ;
 
+        // Newer xmlsec wants the callback order in the opposite direction.
+#if XMLSEC_VERSION_MAJOR > 1 || (XMLSEC_VERSION_MAJOR == 1 && XMLSEC_VERSION_MINOR > 2) || (XMLSEC_VERSION_MAJOR == 1 && XMLSEC_VERSION_MINOR == 2 && XMLSEC_VERSION_SUBMINOR >= 26)
+        //Register the default callbacks.
+        //Notes: the error will cause xmlsec working problems.
+        int cbs = xmlSecIORegisterDefaultCallbacks() ;
+        if( cbs < 0 ) {
+            return -1 ;
+        }
+
+        //Register my classbacks.
+        cbs = xmlSecIORegisterCallbacks(
+                    xmlStreamMatch,
+                    xmlStreamOpen,
+                    xmlStreamRead,
+                    xmlStreamClose ) ;
+        if( cbs < 0 ) {
+            return -1 ;
+        }
+#else
         //Register my classbacks.
         int cbs = xmlSecIORegisterCallbacks(
                     xmlStreamMatch,
@@ -173,6 +192,7 @@ XSECXMLSEC_DLLPUBLIC int xmlEnableStreamInputCallbacks()
         if( cbs < 0 ) {
             return -1 ;
         }
+#endif
 
         enableXmlStreamIO |= XMLSTREAMIO_INITIALIZED ;
     }
-- 
cgit v1.1

<!DOCTYPE html>
<html lang='en'>
<head>
<title>libreoffice/core - main, development code repository</title>
<meta name='generator' content='cgit v1.1'/>
<meta name='robots' content='index, nofollow'/>
<link rel='stylesheet' type='text/css' href='https://cgit.freedesktop.org/cgit.css'/>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://cgit.freedesktop.org/libreoffice/core/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://anongit.freedesktop.org/libreoffice/core' title='libreoffice/core Git repository'/>
<link rel='vcs-git' href='ssh://git.freedesktop.org/git/libreoffice/core' title='libreoffice/core Git repository'/>
<link rel='vcs-git' href='https://anongit.freedesktop.org/git/libreoffice/core.git' title='libreoffice/core Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='https://cgit.freedesktop.org/logo.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a title='libreoffice/core' href='/libreoffice/core/'>libreoffice/core</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='bc4e43dd926bbe6f5315b5c372770ac8c7222177'/><select name='h' onchange='this.form.submit();'>
<option value='aoo/aw080'>aoo/aw080</option>
<option value='aoo/trunk'>aoo/trunk</option>
<option value='distro/capgemini/cg-4.1'>distro/capgemini/cg-4.1</option>
<option value='distro/cib/libreoffice-5-0'>distro/cib/libreoffice-5-0</option>
<option value='distro/cib/libreoffice-5-1'>distro/cib/libreoffice-5-1</option>
<option value='distro/cib/libreoffice-5-2'>distro/cib/libreoffice-5-2</option>
<option value='distro/cib/libreoffice-5-3'>distro/cib/libreoffice-5-3</option>
<option value='distro/cib/libreoffice-5-4'>distro/cib/libreoffice-5-4</option>
<option value='distro/cib/libreoffice-6-0'>distro/cib/libreoffice-6-0</option>
<option value='distro/collabora/cd-5.3'>distro/collabora/cd-5.3</option>
<option value='distro/collabora/cd-5.3-3.1'>distro/collabora/cd-5.3-3.1</option>
<option value='distro/collabora/cd-5.3-3.2'>distro/collabora/cd-5.3-3.2</option>
<option value='distro/collabora/cp-4.0'>distro/collabora/cp-4.0</option>
<option value='distro/collabora/cp-4.1'>distro/collabora/cp-4.1</option>
<option value='distro/collabora/cp-4.2'>distro/collabora/cp-4.2</option>
<option value='distro/collabora/cp-4.3'>distro/collabora/cp-4.3</option>
<option value='distro/collabora/cp-4.4'>distro/collabora/cp-4.4</option>
<option value='distro/collabora/cp-5.0'>distro/collabora/cp-5.0</option>
<option value='distro/collabora/cp-5.1'>distro/collabora/cp-5.1</option>
<option value='distro/collabora/cp-5.3'>distro/collabora/cp-5.3</option>
<option value='distro/collabora/cp-5.3-desktop'>distro/collabora/cp-5.3-desktop</option>
<option value='distro/collabora/cp-6.0'>distro/collabora/cp-6.0</option>
<option value='distro/collabora/lof-4.3'>distro/collabora/lof-4.3</option>
<option value='distro/collabora/lov-4.4'>distro/collabora/lov-4.4</option>
<option value='distro/collabora/lov-5.0'>distro/collabora/lov-5.0</option>
<option value='distro/collabora/lov-5.1'>distro/collabora/lov-5.1</option>
<option value='distro/collabora/lov-5.2'>distro/collabora/lov-5.2</option>
<option value='distro/collabora/lov-6.0.4'>distro/collabora/lov-6.0.4</option>
<option value='distro/collabora/viewer'>distro/collabora/viewer</option>
<option value='distro/collabora/viewer2'>distro/collabora/viewer2</option>
<option value='distro/escriba/escriba-5.2'>distro/escriba/escriba-5.2</option>
<option value='distro/escriba/escriba-5.2.1'>distro/escriba/escriba-5.2.1</option>
<option value='distro/mimo/mimo-4-1-4-2'>distro/mimo/mimo-4-1-4-2</option>
<option value='distro/suse/suse-3.6'>distro/suse/suse-3.6</option>
<option value='distro/suse/suse-3.6-appup'>distro/suse/suse-3.6-appup</option>
<option value='distro/suse/suse-3.6.3'>distro/suse/suse-3.6.3</option>
<option value='distro/suse/suse-4.0'>distro/suse/suse-4.0</option>
<option value='distro/suse/suse-4.0.3'>distro/suse/suse-4.0.3</option>
<option value='distro/ubuntu/oneiric-3.4'>distro/ubuntu/oneiric-3.4</option>
<option value='distro/ubuntu/oneiric-3.4-all'>distro/ubuntu/oneiric-3.4-all</option>
<option value='distro/vector/vector-5.4'>distro/vector/vector-5.4</option>
<option value='distro/vector/vtext-6.5'>distro/vector/vtext-6.5</option>
<option value='feature/5-1-pick'>feature/5-1-pick</option>
<option value='feature/BorderlineFix'>feature/BorderlineFix</option>
<option value='feature/OperationSmiley'>feature/OperationSmiley</option>
<option value='feature/RotGrfFlyFrame'>feature/RotGrfFlyFrame</option>
<option value='feature/RotateFlyFrame'>feature/RotateFlyFrame</option>
<option value='feature/RotateFlyFrame2'>feature/RotateFlyFrame2</option>
<option value='feature/RotateFlyFrame3'>feature/RotateFlyFrame3</option>
<option value='feature/SOSAW080'>feature/SOSAW080</option>
<option value='feature/SfxShell_refcount'>feature/SfxShell_refcount</option>
<option value='feature/SwFrameBorder'>feature/SwFrameBorder</option>
<option value='feature/accfixes2'>feature/accfixes2</option>
<option value='feature/autostyle'>feature/autostyle</option>
<option value='feature/barcode'>feature/barcode</option>
<option value='feature/base-preview'>feature/base-preview</option>
<option value='feature/borderline3'>feature/borderline3</option>
<option value='feature/bplustree'>feature/bplustree</option>
<option value='feature/cairo'>feature/cairo</option>
<option value='feature/calc-data-table'>feature/calc-data-table</option>
<option value='feature/calc-parallel'>feature/calc-parallel</option>
<option value='feature/calctiledrendering'>feature/calctiledrendering</option>
<option value='feature/calctiledrendering2'>feature/calctiledrendering2</option>
<option value='feature/calctiledrendering3'>feature/calctiledrendering3</option>
<option value='feature/calctiledrendering4'>feature/calctiledrendering4</option>
<option value='feature/calctiledrendering5'>feature/calctiledrendering5</option>
<option value='feature/calctiledrendering_alt'>feature/calctiledrendering_alt</option>
<option value='feature/calctiledrendering_attempt3'>feature/calctiledrendering_attempt3</option>
<option value='feature/calctiledrendering_attempt3_2'>feature/calctiledrendering_attempt3_2</option>
<option value='feature/chained-text-boxes'>feature/chained-text-boxes</option>
<option value='feature/change-tracking'>feature/change-tracking</option>
<option value='feature/cib_contract101'>feature/cib_contract101</option>
<option value='feature/cib_contract116'>feature/cib_contract116</option>
<option value='feature/cib_contract136'>feature/cib_contract136</option>
<option value='feature/cib_contract138'>feature/cib_contract138</option>
<option value='feature/cib_contract152'>feature/cib_contract152</option>
<option value='feature/cib_contract152b'>feature/cib_contract152b</option>
<option value='feature/cib_contract561'>feature/cib_contract561</option>
<option value='feature/cib_contract57'>feature/cib_contract57</option>
<option value='feature/cib_contract57b'>feature/cib_contract57b</option>
<option value='feature/cib_contract891'>feature/cib_contract891</option>
<option value='feature/cib_contract935'>feature/cib_contract935</option>
<option value='feature/cmis'>feature/cmis</option>
<option value='feature/components'>feature/components</option>
<option value='feature/coretext'>feature/coretext</option>
<option value='feature/cp-5.0-cairo-svp'>feature/cp-5.0-cairo-svp</option>
<option value='feature/cpu_intrinsics_support'>feature/cpu_intrinsics_support</option>
<option value='feature/dataprovider'>feature/dataprovider</option>
<option value='feature/debugevent'>feature/debugevent</option>
<option value='feature/dematurize01'>feature/dematurize01</option>
<option value='feature/dialog-screenshots'>feature/dialog-screenshots</option>
<option value='feature/docking_windows'>feature/docking_windows</option>
<option value='feature/droid_calcimpress3'>feature/droid_calcimpress3</option>
<option value='feature/droid_calimpress4'>feature/droid_calimpress4</option>
<option value='feature/editviewoverlay'>feature/editviewoverlay</option>
<option value='feature/extended-tooltips'>feature/extended-tooltips</option>
<option value='feature/external-data-ui'>feature/external-data-ui</option>
<option value='feature/fastparser'>feature/fastparser</option>
<option value='feature/firebird-sdbc'>feature/firebird-sdbc</option>
<option value='feature/firebird-sdbc2'>feature/firebird-sdbc2</option>
<option value='feature/firebird-sdbc3'>feature/firebird-sdbc3</option>
<option value='feature/fixes10'>feature/fixes10</option>
<option value='feature/fixes11'>feature/fixes11</option>
<option value='feature/fixes12'>feature/fixes12</option>
<option value='feature/fixes13'>feature/fixes13</option>
<option value='feature/fixes14'>feature/fixes14</option>
<option value='feature/fixes15'>feature/fixes15</option>
<option value='feature/fixes16'>feature/fixes16</option>
<option value='feature/fixes17'>feature/fixes17</option>
<option value='feature/fixes18'>feature/fixes18</option>
<option value='feature/fixes19'>feature/fixes19</option>
<option value='feature/fixes20'>feature/fixes20</option>
<option value='feature/fixes21'>feature/fixes21</option>
<option value='feature/fixes22'>feature/fixes22</option>
<option value='feature/fixes23'>feature/fixes23</option>
<option value='feature/fixes24'>feature/fixes24</option>
<option value='feature/fixes25'>feature/fixes25</option>
<option value='feature/fixes26'>feature/fixes26</option>
<option value='feature/fixes27'>feature/fixes27</option>
<option value='feature/fixes28'>feature/fixes28</option>
<option value='feature/fixes29'>feature/fixes29</option>
<option value='feature/fixes30'>feature/fixes30</option>
<option value='feature/fixes31'>feature/fixes31</option>
<option value='feature/fixes32'>feature/fixes32</option>
<option value='feature/fixes33'>feature/fixes33</option>
<option value='feature/fixes34'>feature/fixes34</option>
<option value='feature/fixes35'>feature/fixes35</option>
<option value='feature/fixes36'>feature/fixes36</option>
<option value='feature/fixes37'>feature/fixes37</option>
<option value='feature/fixes38'>feature/fixes38</option>
<option value='feature/fixes6'>feature/fixes6</option>
<option value='feature/fixes7'>feature/fixes7</option>
<option value='feature/fixes8'>feature/fixes8</option>
<option value='feature/fixes9'>feature/fixes9</option>
<option value='feature/fixstyles3'>feature/fixstyles3</option>
<option value='feature/fontsubtitutions'>feature/fontsubtitutions</option>
<option value='feature/foo'>feature/foo</option>
<option value='feature/gbuild_cli'>feature/gbuild_cli</option>
<option value='feature/gccwrapper'>feature/gccwrapper</option>
<option value='feature/glyphy'>feature/glyphy</option>
<option value='feature/go2'>feature/go2</option>
<option value='feature/gpg4libre'>feature/gpg4libre</option>
<option value='feature/gpg4libre-5-4'>feature/gpg4libre-5-4</option>
<option value='feature/gpg4libre-6-0'>feature/gpg4libre-6-0</option>
<option value='feature/gpg4libre2'>feature/gpg4libre2</option>
<option value='feature/graphicobject'>feature/graphicobject</option>
<option value='feature/gsoc-basic-ide-completion-and-other-bits'>feature/gsoc-basic-ide-completion-and-other-bits</option>
<option value='feature/gsoc-calc-enhanced-db-range'>feature/gsoc-calc-enhanced-db-range</option>
<option value='feature/gsoc14-colors'>feature/gsoc14-colors</option>
<option value='feature/gsoc14-draw-chained-text-boxes'>feature/gsoc14-draw-chained-text-boxes</option>
<option value='feature/gsoc14-draw-text-background-color'>feature/gsoc14-draw-text-background-color</option>
<option value='feature/gsoc14-libcmis'>feature/gsoc14-libcmis</option>
<option value='feature/gsoc14-libcmis2'>feature/gsoc14-libcmis2</option>
<option value='feature/gsoc14-personas'>feature/gsoc14-personas</option>
<option value='feature/gsoc14-personas2'>feature/gsoc14-personas2</option>
<option value='feature/gsoc15-online-update'>feature/gsoc15-online-update</option>
<option value='feature/gsoc15-open-remote-files-dialog'>feature/gsoc15-open-remote-files-dialog</option>
<option value='feature/gsoc17-revamp-customize-dialog'>feature/gsoc17-revamp-customize-dialog</option>
<option value='feature/gsoc2011_wizards'>feature/gsoc2011_wizards</option>
<option value='feature/gtk3_kde5'>feature/gtk3_kde5</option>
<option value='feature/gtk3nativedialogs'>feature/gtk3nativedialogs</option>
<option value='feature/gtktiledviewer'>feature/gtktiledviewer</option>
<option value='feature/ia2'>feature/ia2</option>
<option value='feature/ia2.2'>feature/ia2.2</option>
<option value='feature/ia2.3'>feature/ia2.3</option>
<option value='feature/ia2.4'>feature/ia2.4</option>
<option value='feature/ia2.5'>feature/ia2.5</option>
<option value='feature/improvexlsximport'>feature/improvexlsximport</option>
<option value='feature/instdirlinktargets'>feature/instdirlinktargets</option>
<option value='feature/kde5'>feature/kde5</option>
<option value='feature/lfrb-vcl-opengl'>feature/lfrb-vcl-opengl</option>
<option value='feature/libffi'>feature/libffi</option>
<option value='feature/lok_cellcursor'>feature/lok_cellcursor</option>
<option value='feature/lok_dialog'>feature/lok_dialog</option>
<option value='feature/lok_dialog-backport'>feature/lok_dialog-backport</option>
<option value='feature/lok_dialog2'>feature/lok_dialog2</option>
<option value='feature/lok_sofficemain'>feature/lok_sofficemain</option>
<option value='feature/lok_sofficemain2'>feature/lok_sofficemain2</option>
<option value='feature/mac-opengl-fixes'>feature/mac-opengl-fixes</option>
<option value='feature/mailmerge-toolbar'>feature/mailmerge-toolbar</option>
<option value='feature/mar-updater'>feature/mar-updater</option>
<option value='feature/mariadb'>feature/mariadb</option>
<option value='feature/misc-vba-rework'>feature/misc-vba-rework</option>
<option value='feature/mork'>feature/mork</option>
<option value='feature/nativealpha'>feature/nativealpha</option>
<option value='feature/notebookbar'>feature/notebookbar</option>
<option value='feature/notes-refactoring'>feature/notes-refactoring</option>
<option value='feature/opengl-canvas-rework'>feature/opengl-canvas-rework</option>
<option value='feature/opengl-transitions-rework'>feature/opengl-transitions-rework</option>
<option value='feature/opengl-vcl-text'>feature/opengl-vcl-text</option>
<option value='feature/orcus-continuous-integration'>feature/orcus-continuous-integration</option>
<option value='feature/orcus-odf'>feature/orcus-odf</option>
<option value='feature/orcus-odf-rebased'>feature/orcus-odf-rebased</option>
<option value='feature/orcus-odf-rebased2'>feature/orcus-odf-rebased2</option>
<option value='feature/orcus-rebased'>feature/orcus-rebased</option>
<option value='feature/owncloud-provider-for-android'>feature/owncloud-provider-for-android</option>
<option value='feature/pdfium-master'>feature/pdfium-master</option>
<option value='feature/perfwork4'>feature/perfwork4</option>
<option value='feature/perfwork5'>feature/perfwork5</option>
<option value='feature/pivotcharts'>feature/pivotcharts</option>
<option value='feature/print_revamp'>feature/print_revamp</option>
<option value='feature/priorities'>feature/priorities</option>
<option value='feature/profilesafemode'>feature/profilesafemode</option>
<option value='feature/propose-master-cib'>feature/propose-master-cib</option>
<option value='feature/pytable'>feature/pytable</option>
<option value='feature/pyweb-wizard'>feature/pyweb-wizard</option>
<option value='feature/qt5'>feature/qt5</option>
<option value='feature/qt5+kde5'>feature/qt5+kde5</option>
<option value='feature/refactor-god-objects'>feature/refactor-god-objects</option>
<option value='feature/rendercontext'>feature/rendercontext</option>
<option value='feature/screenshotannotation'>feature/screenshotannotation</option>
<option value='feature/sgexperiment'>feature/sgexperiment</option>
<option value='feature/slidehack'>feature/slidehack</option>
<option value='feature/slidehack2'>feature/slidehack2</option>
<option value='feature/slideshow_onlySprites'>feature/slideshow_onlySprites</option>
<option value='feature/slideshowprimitives'>feature/slideshowprimitives</option>
<option value='feature/stub_writer'>feature/stub_writer</option>
<option value='feature/svg-export'>feature/svg-export</option>
<option value='feature/svg-optimisations'>feature/svg-optimisations</option>
<option value='feature/svg-optimisations-5-0'>feature/svg-optimisations-5-0</option>
<option value='feature/sw-delete-undo-rework'>feature/sw-delete-undo-rework</option>
<option value='feature/table-style'>feature/table-style</option>
<option value='feature/table-style-rebased'>feature/table-style-rebased</option>
<option value='feature/table_rotated_text'>feature/table_rotated_text</option>
<option value='feature/template_manager_improvements'>feature/template_manager_improvements</option>
<option value='feature/template_manager_improvements2'>feature/template_manager_improvements2</option>
<option value='feature/themesupport'>feature/themesupport</option>
<option value='feature/tiled-editing'>feature/tiled-editing</option>
<option value='feature/tscp3'>feature/tscp3</option>
<option value='feature/unitver'>feature/unitver</option>
<option value='feature/unocrsrptr'>feature/unocrsrptr</option>
<option value='feature/unostyles'>feature/unostyles</option>
<option value='feature/unostyles2'>feature/unostyles2</option>
<option value='feature/unostyles3'>feature/unostyles3</option>
<option value='feature/use-ogl-context-in-canvas'>feature/use-ogl-context-in-canvas</option>
<option value='feature/vcl-opengl'>feature/vcl-opengl</option>
<option value='feature/vcl-opengl-integration'>feature/vcl-opengl-integration</option>
<option value='feature/vcl-opengl2'>feature/vcl-opengl2</option>
<option value='feature/vclptr'>feature/vclptr</option>
<option value='feature/vlc'>feature/vlc</option>
<option value='feature/vlc-rb'>feature/vlc-rb</option>
<option value='feature/vs2012'>feature/vs2012</option>
<option value='feature/xtiledrenderable'>feature/xtiledrenderable</option>
<option value='libreoffice-3-5'>libreoffice-3-5</option>
<option value='libreoffice-3-5-0'>libreoffice-3-5-0</option>
<option value='libreoffice-3-5-1'>libreoffice-3-5-1</option>
<option value='libreoffice-3-5-2'>libreoffice-3-5-2</option>
<option value='libreoffice-3-5-3'>libreoffice-3-5-3</option>
<option value='libreoffice-3-5-4'>libreoffice-3-5-4</option>
<option value='libreoffice-3-5-5'>libreoffice-3-5-5</option>
<option value='libreoffice-3-5-6'>libreoffice-3-5-6</option>
<option value='libreoffice-3-5-7'>libreoffice-3-5-7</option>
<option value='libreoffice-3-6'>libreoffice-3-6</option>
<option value='libreoffice-3-6-0'>libreoffice-3-6-0</option>
<option value='libreoffice-3-6-1'>libreoffice-3-6-1</option>
<option value='libreoffice-3-6-2'>libreoffice-3-6-2</option>
<option value='libreoffice-3-6-3'>libreoffice-3-6-3</option>
<option value='libreoffice-3-6-4'>libreoffice-3-6-4</option>
<option value='libreoffice-3-6-5'>libreoffice-3-6-5</option>
<option value='libreoffice-3-6-6'>libreoffice-3-6-6</option>
<option value='libreoffice-3-6-7'>libreoffice-3-6-7</option>
<option value='libreoffice-4-0'>libreoffice-4-0</option>
<option value='libreoffice-4-0-0'>libreoffice-4-0-0</option>
<option value='libreoffice-4-0-1'>libreoffice-4-0-1</option>
<option value='libreoffice-4-0-2'>libreoffice-4-0-2</option>
<option value='libreoffice-4-0-3'>libreoffice-4-0-3</option>
<option value='libreoffice-4-0-4'>libreoffice-4-0-4</option>
<option value='libreoffice-4-0-5'>libreoffice-4-0-5</option>
<option value='libreoffice-4-0-6'>libreoffice-4-0-6</option>
<option value='libreoffice-4-1'>libreoffice-4-1</option>
<option value='libreoffice-4-1-0'>libreoffice-4-1-0</option>
<option value='libreoffice-4-1-1'>libreoffice-4-1-1</option>
<option value='libreoffice-4-1-2'>libreoffice-4-1-2</option>
<option value='libreoffice-4-1-3'>libreoffice-4-1-3</option>
<option value='libreoffice-4-1-4'>libreoffice-4-1-4</option>
<option value='libreoffice-4-1-5'>libreoffice-4-1-5</option>
<option value='libreoffice-4-1-6'>libreoffice-4-1-6</option>
<option value='libreoffice-4-2'>libreoffice-4-2</option>
<option value='libreoffice-4-2-0'>libreoffice-4-2-0</option>
<option value='libreoffice-4-2-1'>libreoffice-4-2-1</option>
<option value='libreoffice-4-2-2'>libreoffice-4-2-2</option>
<option value='libreoffice-4-2-3'>libreoffice-4-2-3</option>
<option value='libreoffice-4-2-4'>libreoffice-4-2-4</option>
<option value='libreoffice-4-2-5'>libreoffice-4-2-5</option>
<option value='libreoffice-4-2-6'>libreoffice-4-2-6</option>
<option value='libreoffice-4-2-7'>libreoffice-4-2-7</option>
<option value='libreoffice-4-2-8'>libreoffice-4-2-8</option>
<option value='libreoffice-4-3'>libreoffice-4-3</option>
<option value='libreoffice-4-3-0'>libreoffice-4-3-0</option>
<option value='libreoffice-4-3-1'>libreoffice-4-3-1</option>
<option value='libreoffice-4-3-2'>libreoffice-4-3-2</option>
<option value='libreoffice-4-3-3'>libreoffice-4-3-3</option>
<option value='libreoffice-4-3-4'>libreoffice-4-3-4</option>
<option value='libreoffice-4-3-5'>libreoffice-4-3-5</option>
<option value='libreoffice-4-3-6'>libreoffice-4-3-6</option>
<option value='libreoffice-4-3-7'>libreoffice-4-3-7</option>
<option value='libreoffice-4-4'>libreoffice-4-4</option>
<option value='libreoffice-4-4-0'>libreoffice-4-4-0</option>
<option value='libreoffice-4-4-1'>libreoffice-4-4-1</option>
<option value='libreoffice-4-4-2'>libreoffice-4-4-2</option>
<option value='libreoffice-4-4-3'>libreoffice-4-4-3</option>
<option value='libreoffice-4-4-4'>libreoffice-4-4-4</option>
<option value='libreoffice-4-4-5'>libreoffice-4-4-5</option>
<option value='libreoffice-4-4-6'>libreoffice-4-4-6</option>
<option value='libreoffice-4-4-7'>libreoffice-4-4-7</option>
<option value='libreoffice-5-0'>libreoffice-5-0</option>
<option value='libreoffice-5-0-0'>libreoffice-5-0-0</option>
<option value='libreoffice-5-0-1'>libreoffice-5-0-1</option>
<option value='libreoffice-5-0-2'>libreoffice-5-0-2</option>
<option value='libreoffice-5-0-3'>libreoffice-5-0-3</option>
<option value='libreoffice-5-0-4'>libreoffice-5-0-4</option>
<option value='libreoffice-5-0-5'>libreoffice-5-0-5</option>
<option value='libreoffice-5-0-6'>libreoffice-5-0-6</option>
<option value='libreoffice-5-1'>libreoffice-5-1</option>
<option value='libreoffice-5-1-0'>libreoffice-5-1-0</option>
<option value='libreoffice-5-1-1'>libreoffice-5-1-1</option>
<option value='libreoffice-5-1-2'>libreoffice-5-1-2</option>
<option value='libreoffice-5-1-3'>libreoffice-5-1-3</option>
<option value='libreoffice-5-1-4'>libreoffice-5-1-4</option>
<option value='libreoffice-5-1-5'>libreoffice-5-1-5</option>
<option value='libreoffice-5-1-6'>libreoffice-5-1-6</option>
<option value='libreoffice-5-2'>libreoffice-5-2</option>
<option value='libreoffice-5-2-0'>libreoffice-5-2-0</option>
<option value='libreoffice-5-2-1'>libreoffice-5-2-1</option>
<option value='libreoffice-5-2-2'>libreoffice-5-2-2</option>
<option value='libreoffice-5-2-3'>libreoffice-5-2-3</option>
<option value='libreoffice-5-2-4'>libreoffice-5-2-4</option>
<option value='libreoffice-5-2-5'>libreoffice-5-2-5</option>
<option value='libreoffice-5-2-6'>libreoffice-5-2-6</option>
<option value='libreoffice-5-2-7'>libreoffice-5-2-7</option>
<option value='libreoffice-5-3'>libreoffice-5-3</option>
<option value='libreoffice-5-3-0'>libreoffice-5-3-0</option>
<option value='libreoffice-5-3-1'>libreoffice-5-3-1</option>
<option value='libreoffice-5-3-2'>libreoffice-5-3-2</option>
<option value='libreoffice-5-3-3'>libreoffice-5-3-3</option>
<option value='libreoffice-5-3-4'>libreoffice-5-3-4</option>
<option value='libreoffice-5-3-5'>libreoffice-5-3-5</option>
<option value='libreoffice-5-3-6'>libreoffice-5-3-6</option>
<option value='libreoffice-5-3-7'>libreoffice-5-3-7</option>
<option value='libreoffice-5-4'>libreoffice-5-4</option>
<option value='libreoffice-5-4-0'>libreoffice-5-4-0</option>
<option value='libreoffice-5-4-1'>libreoffice-5-4-1</option>
<option value='libreoffice-5-4-2'>libreoffice-5-4-2</option>
<option value='libreoffice-5-4-3'>libreoffice-5-4-3</option>
<option value='libreoffice-5-4-4'>libreoffice-5-4-4</option>
<option value='libreoffice-5-4-5'>libreoffice-5-4-5</option>
<option value='libreoffice-5-4-6'>libreoffice-5-4-6</option>
<option value='libreoffice-5-4-7'>libreoffice-5-4-7</option>
<option value='libreoffice-6-0'>libreoffice-6-0</option>
<option value='libreoffice-6-0-0'>libreoffice-6-0-0</option>
<option value='libreoffice-6-0-1'>libreoffice-6-0-1</option>
<option value='libreoffice-6-0-2'>libreoffice-6-0-2</option>
<option value='libreoffice-6-0-3'>libreoffice-6-0-3</option>
<option value='libreoffice-6-0-4'>libreoffice-6-0-4</option>
<option value='libreoffice-6-0-5'>libreoffice-6-0-5</option>
<option value='libreoffice-6-1'>libreoffice-6-1</option>
<option value='master' selected='selected'>master</option>
<option value='ports/macosx10.5/master'>ports/macosx10.5/master</option>
<option value='private/Ashod/cd-5.3.3.2'>private/Ashod/cd-5.3.3.2</option>
<option value='private/Ashod/cp-5.0-preinit'>private/Ashod/cp-5.0-preinit</option>
<option value='private/Ashod/fast-calc-rendering'>private/Ashod/fast-calc-rendering</option>
<option value='private/Ashod/pdfium'>private/Ashod/pdfium</option>
<option value='private/Ashod/pdfium_on_master'>private/Ashod/pdfium_on_master</option>
<option value='private/Ashod/pdfium_on_master_fixed'>private/Ashod/pdfium_on_master_fixed</option>
<option value='private/Rosemary/change-tracking'>private/Rosemary/change-tracking</option>
<option value='private/Sweetshark/killswclient'>private/Sweetshark/killswclient</option>
<option value='private/Sweetshark/lessdepend'>private/Sweetshark/lessdepend</option>
<option value='private/ajrhunt/c4'>private/ajrhunt/c4</option>
<option value='private/ajrhunt/cunit'>private/ajrhunt/cunit</option>
<option value='private/ajrhunt/cunitdemo'>private/ajrhunt/cunitdemo</option>
<option value='private/ajrhunt/firebird-improvement'>private/ajrhunt/firebird-improvement</option>
<option value='private/bansan/chardraw'>private/bansan/chardraw</option>
<option value='private/bubli/gpg4libre'>private/bubli/gpg4libre</option>
<option value='private/bubli/lhm-4-1-6-backports'>private/bubli/lhm-4-1-6-backports</option>
<option value='private/bubli/sw_16bit'>private/bubli/sw_16bit</option>
<option value='private/bubli/textboxchaining'>private/bubli/textboxchaining</option>
<option value='private/hcvcastro/preinit'>private/hcvcastro/preinit</option>
<option value='private/hcvcastro/undo-row-comment'>private/hcvcastro/undo-row-comment</option>
<option value='private/jmux/kde5'>private/jmux/kde5</option>
<option value='private/jmux/libreoffice-4-1-6+backports'>private/jmux/libreoffice-4-1-6+backports</option>
<option value='private/jmux/qt5_fixes'>private/jmux/qt5_fixes</option>
<option value='private/jmux/scheduler-fixes'>private/jmux/scheduler-fixes</option>
<option value='private/jmux/tdf#105288'>private/jmux/tdf#105288</option>
<option value='private/juergen/propose-master'>private/juergen/propose-master</option>
<option value='private/juergen/tr16164'>private/juergen/tr16164</option>
<option value='private/kendy/condformat-api'>private/kendy/condformat-api</option>
<option value='private/kendy/condformat-fdo82014'>private/kendy/condformat-fdo82014</option>
<option value='private/kendy/mailmerge-04'>private/kendy/mailmerge-04</option>
<option value='private/kendy/mailmerge-05'>private/kendy/mailmerge-05</option>
<option value='private/kendy/swinterpreter'>private/kendy/swinterpreter</option>
<option value='private/kendy/testcl'>private/kendy/testcl</option>
<option value='private/khaledhosny/color-fonts'>private/khaledhosny/color-fonts</option>
<option value='private/kohei/chart-bugs'>private/kohei/chart-bugs</option>
<option value='private/kohei/find-replace-all-perf'>private/kohei/find-replace-all-perf</option>
<option value='private/kohei/headless-perf'>private/kohei/headless-perf</option>
<option value='private/kohei/if-or-not-if-jump'>private/kohei/if-or-not-if-jump</option>
<option value='private/kohei/sort-ref-update'>private/kohei/sort-ref-update</option>
<option value='private/lfrb/opengl-vcl'>private/lfrb/opengl-vcl</option>
<option value='private/lgodard/calc_notes_import_export'>private/lgodard/calc_notes_import_export</option>
<option value='private/lgodard/tdf#117202'>private/lgodard/tdf#117202</option>
<option value='private/llunak/mailmerge'>private/llunak/mailmerge</option>
<option value='private/llunak/mailmerge_01'>private/llunak/mailmerge_01</option>
<option value='private/llunak/mailmerge_02'>private/llunak/mailmerge_02</option>
<option value='private/llunak/mailmerge_03'>private/llunak/mailmerge_03</option>
<option value='private/llunak/munich_12587'>private/llunak/munich_12587</option>
<option value='private/lmamane/basetest'>private/lmamane/basetest</option>
<option value='private/lmamane/for-julien2412'>private/lmamane/for-julien2412</option>
<option value='private/lmamane/for-julien2412-master'>private/lmamane/for-julien2412-master</option>
<option value='private/lmamane/tdf110997'>private/lmamane/tdf110997</option>
<option value='private/lmamane/timedate-controls-nanosecond'>private/lmamane/timedate-controls-nanosecond</option>
<option value='private/lmamane/validation'>private/lmamane/validation</option>
<option value='private/mcecchetti/amd/pdf-export-jpeg'>private/mcecchetti/amd/pdf-export-jpeg</option>
<option value='private/mcecchetti/bitmapcrc64'>private/mcecchetti/bitmapcrc64</option>
<option value='private/mcecchetti/bitmapcrc64-5-0'>private/mcecchetti/bitmapcrc64-5-0</option>
<option value='private/mcecchetti/calc-perf-unit-test'>private/mcecchetti/calc-perf-unit-test</option>
<option value='private/mcecchetti/calc-unit-test'>private/mcecchetti/calc-unit-test</option>
<option value='private/mcecchetti/gl-program-binary'>private/mcecchetti/gl-program-binary</option>
<option value='private/mmeeks/aafixes44'>private/mmeeks/aafixes44</option>
<option value='private/mmeeks/bitmapcrc64'>private/mmeeks/bitmapcrc64</option>
<option value='private/mmeeks/currency-dropdown'>private/mmeeks/currency-dropdown</option>
<option value='private/mmeeks/formula-iterator'>private/mmeeks/formula-iterator</option>
<option value='private/mmeeks/gldebug'>private/mmeeks/gldebug</option>
<option value='private/mmeeks/icontest'>private/mmeeks/icontest</option>
<option value='private/mmeeks/opengl-backbuffer'>private/mmeeks/opengl-backbuffer</option>
<option value='private/mmeeks/opengl-backbuffer2'>private/mmeeks/opengl-backbuffer2</option>
<option value='private/mmeeks/vcl-opengl3'>private/mmeeks/vcl-opengl3</option>
<option value='private/moggi/fix-opengl-context-problems'>private/moggi/fix-opengl-context-problems</option>
<option value='private/moggi/improved-dxf-xls-export'>private/moggi/improved-dxf-xls-export</option>
<option value='private/moggi/opengl-4-4-build-test'>private/moggi/opengl-4-4-build-test</option>
<option value='private/moggi/opengl-preparation'>private/moggi/opengl-preparation</option>
<option value='private/moggi/opengl-vcl-win'>private/moggi/opengl-vcl-win</option>
<option value='private/moggi/orcus-improvements'>private/moggi/orcus-improvements</option>
<option value='private/moggi/track-win-dc'>private/moggi/track-win-dc</option>
<option value='private/moggi/ui-test'>private/moggi/ui-test</option>
<option value='private/moggi/vcl-opengl3'>private/moggi/vcl-opengl3</option>
<option value='private/mst/sw_redlinehide'>private/mst/sw_redlinehide</option>
<option value='private/pranavk/modernize_gtktiledviewer'>private/pranavk/modernize_gtktiledviewer</option>
<option value='private/swe/libreoffice-5-2+backports'>private/swe/libreoffice-5-2+backports</option>
<option value='private/sweetshark/swdepend'>private/sweetshark/swdepend</option>
<option value='private/tbsdy/clipping'>private/tbsdy/clipping</option>
<option value='private/tbsdy/drawserverfontlayout'>private/tbsdy/drawserverfontlayout</option>
<option value='private/tbsdy/emf'>private/tbsdy/emf</option>
<option value='private/tbsdy/osl_getAllEnvironment'>private/tbsdy/osl_getAllEnvironment</option>
<option value='private/tbsdy/outdev'>private/tbsdy/outdev</option>
<option value='private/tbsdy/printinfomgr'>private/tbsdy/printinfomgr</option>
<option value='private/tbsdy/workbench'>private/tbsdy/workbench</option>
<option value='private/tml/android-use-bionic-linker-copy'>private/tml/android-use-bionic-linker-copy</option>
<option value='private/tml/android-use-faulty.lib'>private/tml/android-use-faulty.lib</option>
<option value='private/tml/fixwintext'>private/tml/fixwintext</option>
<option value='private/tml/iculess'>private/tml/iculess</option>
<option value='private/tml/opencl-default-1'>private/tml/opencl-default-1</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>main, development code repository</td><td class='sub right'>root</td></tr></table>
<table class='tabs'><tr><td>
<a href='/libreoffice/core/'>summary</a><a href='/libreoffice/core/refs/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>refs</a><a href='/libreoffice/core/log/'>log</a><a href='/libreoffice/core/tree/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>tree</a><a class='active' href='/libreoffice/core/commit/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>commit</a><a href='/libreoffice/core/diff/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>diff</a></td><td class='form'><form class='right' method='get' action='/libreoffice/core/log/'>
<input type='hidden' name='id' value='bc4e43dd926bbe6f5315b5c372770ac8c7222177'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='text' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='bc4e43dd926bbe6f5315b5c372770ac8c7222177'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Miklos Vajna &lt;vmiklos@collabora.co.uk&gt;</td><td class='right'>2018-06-07 21:24:09 +0200</td></tr>
<tr><th>committer</th><td>Miklos Vajna &lt;vmiklos@collabora.co.uk&gt;</td><td class='right'>2018-06-08 08:11:46 +0200</td></tr>
<tr><th>commit</th><td colspan='2' class='sha1'><a href='/libreoffice/core/commit/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>bc4e43dd926bbe6f5315b5c372770ac8c7222177</a> (<a href='/libreoffice/core/patch/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='sha1'><a href='/libreoffice/core/tree/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>821901c8127378ae9547cfdc0233813c3fc145e0</a></td></tr>
<tr><th>parent</th><td colspan='2' class='sha1'><a href='/libreoffice/core/commit/?id=5708534b942c1d0ce384f6a8473da6bb569410e7'>5708534b942c1d0ce384f6a8473da6bb569410e7</a> (<a href='/libreoffice/core/diff/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177&amp;id2=5708534b942c1d0ce384f6a8473da6bb569410e7'>diff</a>)</td></tr></table>
<div class='commit-subject'>xmlsecurity: check for the libxmlsec version runtime, not build-time<span class='decoration'><a class='deco' href='/libreoffice/core/commit/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>HEAD</a><a class='branch-deco' href='/libreoffice/core/log/'>master</a></span></div><div class='commit-msg'>For the general benefit of --with-system-xmlsec usage scenarios (where
LO may be built against an old version of xmlsec and run against a new
one).

Change-Id: I4ae582771dbc8eec149a706cfa5ccc0ec0859704
Reviewed-on: https://gerrit.libreoffice.org/55446
Tested-by: Jenkins &lt;ci@libreoffice.org&gt;
Reviewed-by: Miklos Vajna &lt;vmiklos@collabora.co.uk&gt;
</div><div class='diffstat-header'><a href='/libreoffice/core/diff/?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/libreoffice/core/diff/xmlsecurity/source/xmlsec/xmlstreamio.cxx?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>xmlsecurity/source/xmlsec/xmlstreamio.cxx</a></td><td class='right'>69</td><td class='graph'><table summary='file diffstat' width='69%'><tr><td class='add' style='width: 52.2%;'/><td class='rem' style='width: 47.8%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>1 files changed, 36 insertions, 33 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/xmlsecurity/source/xmlsec/xmlstreamio.cxx b/xmlsecurity/source/xmlsec/xmlstreamio.cxx<br/>index 83dd83e..910944e 100644<br/>--- a/<a href='/libreoffice/core/tree/xmlsecurity/source/xmlsec/xmlstreamio.cxx?id=5708534b942c1d0ce384f6a8473da6bb569410e7'>xmlsecurity/source/xmlsec/xmlstreamio.cxx</a><br/>+++ b/<a href='/libreoffice/core/tree/xmlsecurity/source/xmlsec/xmlstreamio.cxx?id=bc4e43dd926bbe6f5315b5c372770ac8c7222177'>xmlsecurity/source/xmlsec/xmlstreamio.cxx</a></div><div class='hunk'>@@ -158,41 +158,44 @@ XSECXMLSEC_DLLPUBLIC int xmlEnableStreamInputCallbacks()</div><div class='ctx'>         xmlSecIOCleanupCallbacks() ;</div><div class='ctx'> </div><div class='ctx'>         // Newer xmlsec wants the callback order in the opposite direction.</div><div class='del'>-#if XMLSEC_VERSION_MAJOR &gt; 1 || (XMLSEC_VERSION_MAJOR == 1 &amp;&amp; XMLSEC_VERSION_MINOR &gt; 2) || (XMLSEC_VERSION_MAJOR == 1 &amp;&amp; XMLSEC_VERSION_MINOR == 2 &amp;&amp; XMLSEC_VERSION_SUBMINOR &gt;= 26)</div><div class='del'>-        //Register the default callbacks.</div><div class='del'>-        //Notes: the error will cause xmlsec working problems.</div><div class='del'>-        int cbs = xmlSecIORegisterDefaultCallbacks() ;</div><div class='del'>-        if( cbs &lt; 0 ) {</div><div class='del'>-            return -1 ;</div><div class='del'>-        }</div><div class='del'>-</div><div class='del'>-        //Register my classbacks.</div><div class='del'>-        cbs = xmlSecIORegisterCallbacks(</div><div class='del'>-                    xmlStreamMatch,</div><div class='del'>-                    xmlStreamOpen,</div><div class='del'>-                    xmlStreamRead,</div><div class='del'>-                    xmlStreamClose ) ;</div><div class='del'>-        if( cbs &lt; 0 ) {</div><div class='del'>-            return -1 ;</div><div class='del'>-        }</div><div class='del'>-#else</div><div class='del'>-        //Register my classbacks.</div><div class='del'>-        int cbs = xmlSecIORegisterCallbacks(</div><div class='del'>-                    xmlStreamMatch,</div><div class='del'>-                    xmlStreamOpen,</div><div class='del'>-                    xmlStreamRead,</div><div class='del'>-                    xmlStreamClose ) ;</div><div class='del'>-        if( cbs &lt; 0 ) {</div><div class='del'>-            return -1 ;</div><div class='add'>+        if (xmlSecCheckVersionExt(1, 2, 26, xmlSecCheckVersionABICompatible))</div><div class='add'>+        {</div><div class='add'>+            //Register the default callbacks.</div><div class='add'>+            //Notes: the error will cause xmlsec working problems.</div><div class='add'>+            int cbs = xmlSecIORegisterDefaultCallbacks() ;</div><div class='add'>+            if( cbs &lt; 0 ) {</div><div class='add'>+                return -1 ;</div><div class='add'>+            }</div><div class='add'>+</div><div class='add'>+            //Register my classbacks.</div><div class='add'>+            cbs = xmlSecIORegisterCallbacks(</div><div class='add'>+                        xmlStreamMatch,</div><div class='add'>+                        xmlStreamOpen,</div><div class='add'>+                        xmlStreamRead,</div><div class='add'>+                        xmlStreamClose ) ;</div><div class='add'>+            if( cbs &lt; 0 ) {</div><div class='add'>+                return -1 ;</div><div class='add'>+            }</div><div class='ctx'>         }</div><div class='del'>-</div><div class='del'>-        //Register the default callbacks.</div><div class='del'>-        //Notes: the error will cause xmlsec working problems.</div><div class='del'>-        cbs = xmlSecIORegisterDefaultCallbacks() ;</div><div class='del'>-        if( cbs &lt; 0 ) {</div><div class='del'>-            return -1 ;</div><div class='add'>+        else</div><div class='add'>+        {</div><div class='add'>+            //Register my classbacks.</div><div class='add'>+            int cbs = xmlSecIORegisterCallbacks(</div><div class='add'>+                        xmlStreamMatch,</div><div class='add'>+                        xmlStreamOpen,</div><div class='add'>+                        xmlStreamRead,</div><div class='add'>+                        xmlStreamClose ) ;</div><div class='add'>+            if( cbs &lt; 0 ) {</div><div class='add'>+                return -1 ;</div><div class='add'>+            }</div><div class='add'>+</div><div class='add'>+            //Register the default callbacks.</div><div class='add'>+            //Notes: the error will cause xmlsec working problems.</div><div class='add'>+            cbs = xmlSecIORegisterDefaultCallbacks() ;</div><div class='add'>+            if( cbs &lt; 0 ) {</div><div class='add'>+                return -1 ;</div><div class='add'>+            }</div><div class='ctx'>         }</div><div class='del'>-#endif</div><div class='ctx'> </div><div class='ctx'>         enableXmlStreamIO |= XMLSTREAMIO_INITIALIZED ;</div><div class='ctx'>     }</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit v1.1</a> at 2018-06-08 06:30:41 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
