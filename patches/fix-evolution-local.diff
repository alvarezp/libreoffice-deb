--- /dev/null	2011-03-30 10:29:57.024592290 +0200
+++ libreoffice-3.3.2/libreoffice-build/patches/dev300/fix-evolution-local.diff	2011-04-01 19:42:04.000000000 +0200
@@ -0,0 +1,56 @@
+ connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx |   13 +++++++------
+ connectivity/source/drivers/evoab2/NResultSet.cxx        |    3 ++-
+ 2 files changed, 9 insertions(+), 7 deletions(-)
+
+New commits:
+commit 2833c4cb4dc6c6def3d3cb3b134f22eda3a87207
+Author: Michael Meeks <michael.meeks@novell.com>
+Date:   Fri Apr 1 15:55:42 2011 +0100
+
+    fix evolution local addressbook integration, which uses a new local: uri
+
+diff --git a/connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx b/connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx
+index c6dc8bb..d868b2a 100644
+--- connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx
++++ connectivity/source/drivers/evoab2/NDatabaseMetaData.cxx
+@@ -1147,19 +1147,20 @@ Reference< XResultSet > SAL_CALL OEvoabDatabaseMetaData::getTables(
+ 
+         switch (m_pConnection->getSDBCAddressType()) {
+         case SDBCAddress::EVO_GWISE:
+-                    if (0==strncmp( "groupwise://", p, 11 ))
++                    if ( !strncmp( "groupwise://", p, 11 ))
+                         break;
+-                    else 
++                    else
+                         continue;
+         case SDBCAddress::EVO_LOCAL:
+-                    if (0==strncmp( "file://", p, 6 ))
++                    if ( !strncmp( "file://", p, 6 ) ||
++                         !strncmp( "local://", p, 6 ) )
+                         break;
+                     else
+                         continue;
+-        case SDBCAddress::EVO_LDAP: 
+-                    if (0==strncmp( "ldap://", p, 6 ))
++        case SDBCAddress::EVO_LDAP:
++                    if ( !strncmp( "ldap://", p, 6 ))
+                         break;
+-                    else 
++                    else
+                         continue;
+         case SDBCAddress::Unknown:
+             break;
+diff --git a/connectivity/source/drivers/evoab2/NResultSet.cxx b/connectivity/source/drivers/evoab2/NResultSet.cxx
+index 4bea08a..e16e459 100644
+--- connectivity/source/drivers/evoab2/NResultSet.cxx
++++ connectivity/source/drivers/evoab2/NResultSet.cxx
+@@ -182,7 +182,8 @@ static bool isLDAP( EBook *pBook )
+ 
+ static bool isLocal( EBook *pBook )
+ {
+-    return pBook && !strncmp( "file://", e_book_get_uri( pBook ), 6 );
++    return pBook && ( !strncmp( "file://", e_book_get_uri( pBook ), 6 ) ||
++                      !strncmp( "local:", e_book_get_uri( pBook ), 6 ) );
+ }
+ 
+ static bool isAuthRequired( EBook *pBook )
--- libreoffice-3.3.2/libreoffice-build/patches/dev300/apply-old	2011-04-01 19:43:52.000000000 +0200
+++ libreoffice-3.3.2/libreoffice-build/patches/dev300/apply	2011-04-01 19:44:02.000000000 +0200
@@ -845,6 +845,7 @@
 # I think that the Evolution 1.x address book is obsolete anyway
 buildfix-evo1-vs-evo2.diff, bnc#496902, i#101439, pmladek
 
+fix-evolution-local.diff
 
 [ DebianBaseOnly ]
 # add JDK paths for MySQL, PostgreSQL, JTDS
