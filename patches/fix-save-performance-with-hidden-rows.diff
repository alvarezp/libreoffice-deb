diff --git a/patches/dev300/apply b/patches/dev300/apply
index d0759aa..e8f7e33 100644
--- openoffice.org-3.2.1/ooo-build-3-2-1-3/patches/dev300/apply
+++ openoffice.org-3.2.1/ooo-build-3-2-1-3/patches/dev300/apply
@@ -3862,6 +3862,9 @@ mdds-prj-d-lst.diff,     kohei
 mdds-build-dependency-sc.diff, kohei
 system-mdds.diff, rengelha
 
+# Fix poor performance on saving document with hidden rows.
+calc-perf-ods-export-hidden-rows.diff, deb#582785, kohei
+
 [ GentooExperimental ]
 SectionOwner => hmth
 # jemalloc, FreeBSD 7 allocator
diff --git a/patches/dev300/calc-perf-ods-export-hidden-rows.diff b/patches/dev300/calc-perf-ods-export-hidden-rows.diff
new file mode 100644
index 0000000..9fa54e1
--- /dev/null
+++ openoffice.org-3.2.1/ooo-build-3-2-1-3/patches/dev300/calc-perf-ods-export-hidden-rows.diff
@@ -0,0 +1,25 @@
+diff --git sc/source/core/data/document.cxx sc/source/core/data/document.cxx
+index 6490cf4..75c5266 100644
+--- sc/source/core/data/document.cxx
++++ sc/source/core/data/document.cxx
+@@ -3717,15 +3717,18 @@ SCROW ScDocument::GetNextDifferentChangedRow( SCTAB nTab, SCROW nStart, bool bCa
+ {
+     if ( ValidTab(nTab) && pTab[nTab] && pTab[nTab]->GetRowFlagsArray() && pTab[nTab]->mpRowHeights )
+     {
++        // Use the original row height for comparison, which may not be zero 
++        // even for hidden rows; it's the height before the row has become
++        // hidden.
+         BYTE nStartFlags = pTab[nTab]->GetRowFlags(nStart);
+-        USHORT nStartHeight = pTab[nTab]->GetOriginalHeight(nStart);
++        USHORT nStartHeight = pTab[nTab]->GetRowHeight(nStart, NULL, NULL, false);
+         for (SCROW nRow = nStart + 1; nRow <= MAXROW; nRow++)
+         {
+             size_t nIndex;          // ignored
+             SCROW nFlagsEndRow;
+             SCROW nHeightEndRow;
+             BYTE nFlags = pTab[nTab]->GetRowFlagsArray()->GetValue( nRow, nIndex, nFlagsEndRow );
+-            USHORT nHeight = pTab[nTab]->GetRowHeight(nRow, NULL, &nHeightEndRow);
++            USHORT nHeight = pTab[nTab]->GetRowHeight(nRow, NULL, &nHeightEndRow, false);
+             if (((nStartFlags & CR_MANUALBREAK) != (nFlags & CR_MANUALBREAK)) ||
+                 ((nStartFlags & CR_MANUALSIZE) != (nFlags & CR_MANUALSIZE)) ||
+                 (bCareManualSize && (nStartFlags & CR_MANUALSIZE) && (nStartHeight != nHeight)) ||
