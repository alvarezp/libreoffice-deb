--- /dev/null	2011-09-27 10:05:06.408221032 +0200
+++ libreoffice-3.4.3/libreoffice-build/patches/hotfixes/poppler-0.17.x.diff	2011-09-30 01:46:25.000000000 +0200
@@ -0,0 +1,101 @@
+rom f6f8f67460bba296c49f794d14621b7313df4f7d Mon Sep 17 00:00:00 2001
+From: Caolán McNamara <caolanm@redhat.com>
+Date: Tue, 19 Jul 2011 07:54:07 +0000
+Subject: poppler 0.17.0 changed its api for no some reason or othe
+
+From 91313fc05abbfe35ee1e0c2464a28dd580780f07 Mon Sep 17 00:00:00 2001
+From: Caolán McNamara <caolanm@redhat.com>
+Date: Fri, 02 Sep 2011 12:15:49 +0000
+Subject: Resolves: rhbz#735182 libreoffice doesn't build with poppler-0.17.3
+
+From 8861df394604fa6dd8c72181a023557d037f7235 Mon Sep 17 00:00:00 2001
+From: Luboš Luňák <l.lunak@suse.cz>
+Date: Wed, 21 Sep 2011 15:13:25 +0000
+Subject: build without glib poppler bindings
+
+- there's not configure check for it, only for poppler itself
+- and it's not actually used anyway
+
+From 0f862a7432737d16056270cf8fbc29478f988f7d Mon Sep 17 00:00:00 2001
+From: Rene Engelhard <rene@debian.org>
+Date: Wed, 28 Sep 2011 20:40:07 +0000
+Subject: make configure check for cpp/poppler-version.h
+
+--- sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.cxx
++++ sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.cxx
+@@ -150,7 +150,11 @@
+ void writeJpeg_( OutputBuffer& o_rOutputBuf, Stream* str, bool bWithLinefeed )
+ {
+     // dump JPEG file as-is
++#if POPPLER_CHECK_VERSION(0, 17, 3)
++    str = str->getBaseStream();
++#else
+     str = ((DCTStream *)str)->getRawStream();
++#endif
+     str->reset();
+ 
+     int c;
+@@ -489,7 +493,11 @@
+     printf("endPage\n");
+ }
+ 
++#if POPPLER_CHECK_VERSION(0, 17, 0)
++void PDFOutDev::processLink(AnnotLink *link, Catalog *)
++#else
+ void PDFOutDev::processLink(Link* link, Catalog*)
++#endif
+ {
+     assert(link);
+ 
+unchanged:
+--- sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.hxx
++++ sdext/source/pdfimport/xpdfwrapper/pdfioutdev_gpl.hxx
+@@ -65,7 +65,14 @@
+ class GfxFont;
+ class PDFDoc;
+ #ifndef SYSTEM_POPPLER
++#define POPPLER_CHECK_VERSION(major,minor,micro) (0)
+ typedef GString GooString;
++#else
++#include <cpp/poppler-version.h>
++#define POPPLER_CHECK_VERSION(major,minor,micro) \
++  (POPPLER_VERSION_MAJOR > (major) || \
++   (POPPLER_VERSION_MAJOR == (major) && POPPLER_VERSION_MINOR > (minor)) || \
++   (POPPLER_VERSION_MAJOR == (major) && POPPLER_VERSION_MINOR == (minor) && POPPLER_VERSION_MICRO >= (micro)))
+ #endif
+ 
+ namespace pdfi
+@@ -194,8 +201,12 @@
+         // virtual void cvtDevToUser(double dx, double dy, double *ux, double *uy);
+         // virtual void cvtUserToDev(double ux, double uy, int *dx, int *dy);
+ 
++        #if POPPLER_CHECK_VERSION(0, 17, 0)
++        virtual void processLink(AnnotLink *link, Catalog *catalog);
++        #else
+         //----- link borders
+         virtual void processLink(Link *link, Catalog *catalog);
++        #endif
+ 
+         //----- save/restore graphics state
+         virtual void saveState(GfxState *state);
+only in patch2:
+unchanged:
+--- configure.in
++++ configure.in
+@@ -7034,6 +7034,16 @@ if test "x$enable_ext_pdfimport" != "xno" -a "x$enable_extension_integration" !=
+       AC_MSG_RESULT([external])
+       SYSTEM_POPPLER=YES
+       PKG_CHECK_MODULES( POPPLER, poppler >= 0.8.0 )
++      AC_LANG_PUSH([C++])
++      save_CXXFLAGS=$CXXFLAGS
++      save_CPPFLAGS=$CPPFLAGS
++      CXXFLAGS="$CXXFLAGS $POPPLER_CFLAGS"
++      CPPFLAGS="$CPPFLAGS $POPPLER_CFLAGS"
++      AC_CHECK_HEADER([cpp/poppler-version.h], [],
++                   [AC_MSG_ERROR([cpp/poppler-version.h not found. Install poppler])], [])
++      CXXFLAGS=$save_CXXFLAGS
++      CPPFLAGS=$save_CPPFLAGS
++      AC_LANG_POP([C++])
+   else
+       AC_MSG_RESULT([internal])
+       SYSTEM_POPPLER=NO
