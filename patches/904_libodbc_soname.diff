Patch taken from IZ#14940

Index: oo_cvs/dbaccess/source/ui/dlg/odbcconfig.cxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/odbcconfig.cxx,v
retrieving revision 1.8
diff -u -3 -p -r1.8 odbcconfig.cxx
--- oo_cvs/dbaccess/source/ui/dlg/odbcconfig.cxx	19 Mar 2003 17:52:26 -0000	1.8
+++ oo_cvs/dbaccess/source/ui/dlg/odbcconfig.cxx	27 May 2003 16:04:42 -0000
@@ -84,6 +84,8 @@
 #define ODBC_UI_LIBRARY	"ODBCCP32.DLL"
 #endif
 #ifdef UNX
+#define ODBC_LIBRARY_1		"libodbc.so.1"
+#define ODBC_UI_LIBRARY_1	"libodbcinst.so.1"
 #define ODBC_LIBRARY	"libodbc.so"
 #define ODBC_UI_LIBRARY	"libodbcinst.so"
 #endif
@@ -137,15 +139,15 @@ typedef SQLRETURN (SQL_API* TSQLDataSour
 //= OOdbcLibWrapper
 //=========================================================================
 //-------------------------------------------------------------------------
-OOdbcLibWrapper::OOdbcLibWrapper(const sal_Char* _pLibPath)
-	:m_sLibPath(::rtl::OUString::createFromAscii(_pLibPath))
-	,m_pOdbcLib(NULL)
+OOdbcLibWrapper::OOdbcLibWrapper()
+	:m_pOdbcLib(NULL)
 {
 }
 
 //-------------------------------------------------------------------------
-sal_Bool OOdbcLibWrapper::load()
+sal_Bool OOdbcLibWrapper::load(const sal_Char* _pLibPath)
 {
+	m_sLibPath = ::rtl::OUString::createFromAscii(_pLibPath);
 #ifdef HAVE_ODBC_SUPPORT
 	// load the module
 	m_pOdbcLib = osl_loadModule(m_sLibPath.pData, SAL_LOADMODULE_NOW);
@@ -192,14 +194,19 @@ struct OdbcTypesImpl
 //-------------------------------------------------------------------------
 OOdbcEnumeration::OOdbcEnumeration()
 #ifdef HAVE_ODBC_SUPPORT
-	:OOdbcLibWrapper(ODBC_LIBRARY)
-	,m_pAllocHandle(NULL)
+	:m_pAllocHandle(NULL)
 	,m_pSetEnvAttr(NULL)
 	,m_pDataSources(NULL)
 	,m_pImpl(new OdbcTypesImpl)
 #endif
 {
-	if (load())
+	sal_Bool bLoaded = load(ODBC_LIBRARY);
+#ifdef ODBC_LIBRARY_1
+	if ( !bLoaded )
+		bLoaded = load(ODBC_LIBRARY_1);
+#endif
+
+	if ( bLoaded )
 	{
 #ifdef HAVE_ODBC_SUPPORT
 		// load the generic functions
@@ -301,12 +308,16 @@ void OOdbcEnumeration::getDatasourceName
 //=========================================================================
 //-------------------------------------------------------------------------
 OOdbcManagement::OOdbcManagement()
-	:OOdbcLibWrapper(ODBC_UI_LIBRARY)
 #ifdef HAVE_ODBC_SUPPORT
-	,m_pSQLManageDataSource(NULL)
+:m_pSQLManageDataSource(NULL)
 #endif
 {
-	if (load())
+	sal_Bool bLoaded = load(ODBC_UI_LIBRARY);
+#ifdef ODBC_UI_LIBRARY_1
+	if ( !bLoaded )
+		bLoaded = load(ODBC_UI_LIBRARY_1);
+#endif
+	if ( bLoaded )
 	{
 #ifdef HAVE_ODBC_SUPPORT
 		m_pSQLManageDataSource = loadSymbol("SQLManageDataSources");
Index: oo_cvs/dbaccess/source/ui/dlg/odbcconfig.hxx
===================================================================
RCS file: /cvs/dba/dbaccess/source/ui/dlg/odbcconfig.hxx,v
retrieving revision 1.3
diff -u -3 -p -r1.3 odbcconfig.hxx
--- oo_cvs/dbaccess/source/ui/dlg/odbcconfig.hxx	19 Mar 2003 17:52:26 -0000	1.3
+++ oo_cvs/dbaccess/source/ui/dlg/odbcconfig.hxx	27 May 2003 16:04:42 -0000
@@ -103,13 +103,13 @@ protected:
 #ifndef HAVE_ODBC_SUPPORT
 	OOdbcLibWrapper() : m_pOdbcLib(NULL) { }
 #endif
-	OOdbcLibWrapper(const sal_Char* _pLibPath);
+	OOdbcLibWrapper();
 	~OOdbcLibWrapper();
 
 	void*	loadSymbol(const sal_Char* _pFunctionName);
 
 	/// load the lib
-	sal_Bool	load();
+	sal_Bool	load(const sal_Char* _pLibPath);
 	/// unload the lib
 	void		unload();
 };
Index: oo_cvs/connectivity/source/drivers/odbc/OFunctions.cxx
===================================================================
RCS file: /cvs/dba/connectivity/source/drivers/odbc/OFunctions.cxx,v
retrieving revision 1.4
diff -u -3 -p -r1.4 OFunctions.cxx
--- oo_cvs/connectivity/source/drivers/odbc/OFunctions.cxx	15 May 2001 08:18:13 -0000	1.4
+++ oo_cvs/connectivity/source/drivers/odbc/OFunctions.cxx	27 May 2003 16:04:42 -0000
@@ -152,12 +152,16 @@ sal_Bool LoadLibrary_ODBC3(::rtl::OUStri
 	_rPath = ::rtl::OUString::createFromAscii("ODBC32.DLL");
 #endif
 #ifdef UNX
+	_rPath = ::rtl::OUString::createFromAscii("libodbc.so.1");
+	pODBCso = osl_loadModule( _rPath.pData,SAL_LOADMODULE_NOW );
+	if ( !pODBCso )
 	_rPath = ::rtl::OUString::createFromAscii("libodbc.so");
 #endif
 #ifdef OS2
 	_rPath = ::rtl::OUString::createFromAscii("ODBC");
 #endif
 
+	if ( !pODBCso )
 	pODBCso = osl_loadModule( _rPath.pData,SAL_LOADMODULE_NOW );
 	if( !pODBCso)
 #ifdef OS2
